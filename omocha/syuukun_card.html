<!DOCTYPE html>
<html lang="ja">
    <head prefix="og: http://ogp.me/ns# website: http://ogp.me/ns/website#">
        <meta charset="UTF-8">
        <!--æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯ä¸Šã®ã»ã†ã«ãªã„ã¨ã™ã¹ã¦ãŠã—ã¾ã„ã«ãªã‚‹ã‚‰ã—ã„-->
        <meta name="description" content="ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ä½œã‚ŠãŸã„">
        <title>JUNæ±ï½—ãŠã‚‚ã¡ã‚ƒã°ã“ã€‚/ãŠã‚‚ã¡ã‚ƒ/ã—ã‚…ã†ãã‚“ã‚«ãƒ¼ãƒ‰</title>
        <!--OGPã¨ã‹ã„ã†ã®-->
        <meta property="og:site_name" content="JUNæ±ï½—ãŠã‚‚ã¡ã‚ƒã°ã“ã€‚/omocha/syuukun_card">                                <!--ã‚¿ã‚¤ãƒˆãƒ«ã€€å…¥åŠ›ã™ã‚‹ã“ã¨ï¼-->
        <meta property="og:title" content="ã—ã‚…ã†ãã‚“ã‚«ãƒ¼ãƒ‰">                                                               <!--ã‚¿ã‚¤ãƒˆãƒ«ã€€å…¥åŠ›ã™ã‚‹ã“ã¨ï¼-->
        <meta property="og:type" content="article"> <!--websiteã¯ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã€articleãŒè¨˜äº‹ã ã£ã¦ã•-->
        <meta property="og:url" content="https://junjiruw.github.io/DEYUTI/omocha/syuukun_card.html">                   <!--ãƒªãƒ³ã‚¯ã€€å…¥åŠ›ã™ã‚‹ã“ã¨ï¼-->
        <meta property="og:image" content="https://github.com/junjiruw/DEYUTI/blob/master/images/site/junjiruw_bako.png?raw=true">
        <meta name="twitter:card" content="summary"><!--ãªã«ã‚’è¡¨ç¤ºã™ã‚‹ã‹-->
        <meta name="twitter:site" content="@junjiruw"><!--ãƒ•ãƒƒã‚¿ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚‰ã—ã„â€¦ã©ã“ï¼Ÿ-->
        <link rel="stylesheet" href="../css/style.css">
        
        <link rel="icon" href="../images/site/favicon32.png">
        <style>

            div#mannaka{
                width: 98%;
                margin: auto;
                background: #16151a;
                border: 2px solid #ffffff;
                color: #ffffff;   
                font-size: 16px;    
            }

            div#parent_div{
                text-align: center;
                margin: 10px;
            }
            canvas{
                background: #ffffff;
                height: 70vh;/*ã“ã‚Œã€PCãƒ–ãƒ©ã‚¦ã‚¶ã§æ¨ªã«ç‹­ãã—ãŸã‚‰å´©å£Šã›ãˆã¸ã‚“ï¼Ÿâ†’å‹æ‰‹ã«å´©å£Šã—ã¦ã‚*/
                /*image-rendering: pixelated;ãƒ‰ãƒƒãƒˆçµµã‚’æ‹¡å¤§ã—ãŸã„ãªã‚‰ä½¿ãˆ*/
            }


            div#buttons{
                display: flex;
            }
            input.key_button{
                background-color: #FFFFFF;
                width: 1.5em;
                height: 1.5em;
                font-size: 2em;
                font-family: "misaki_gothic";
                margin: 0.25em;
                margin-left: 1em;
            }
            input.key_button:active{
                background-color: #656965;
                color: #FFFFFF;
            }
            div#button_left{
                text-align: left;
                width: 50%;
            }
            div#button_left div{
                text-align: center;
            }
            div#button_right{
                text-align: center;
                width: 50%;
            }

        </style>
        <script src="../js/public.js"></script>
        <script>
            //ç´ æèª­ã¿è¾¼ã¿
            var test=new Image();
            test.src="../images/omocha/syuukun_card/200130.png";
            var test_syuukun=new Image();
            test_syuukun.src="../images/omocha/syuukun_card/test_syuukun200130.png";
            var turn_end=new Image();
            turn_end.src="../images/omocha/syuukun_card/ta-nendman.png";
            var yamahuda=new Image();
            yamahuda.src="../images/omocha/syuukun_card/yamahuda.png";
            var hakaba=new Image();
            hakaba.src="../images/omocha/syuukun_card/hakaba64.png";
            var card_basyo=new Image();
            card_basyo.src="../images/omocha/syuukun_card/card_basyo.png";
            var yubi=new Image();
            yubi.src="../images/omocha/syuukun_card/ka-soru64.png";//å˜˜ã€‚æ‹¡å¤§ã—ãŸã‹ã‚‰128
            var atk_plate=new Image();
            atk_plate.src="../images/omocha/syuukun_card/atk_plate.png";
            var def_plate=new Image();
            def_plate.src="../images/omocha/syuukun_card/def_plate.png";
            var atk_circle=new Image();
            atk_circle.src="../images/omocha/syuukun_card/atk_circle.png";
            var zuba64=new Image();
            zuba64.src="../images/omocha/syuukun_card/zuba64.png";
            var kati_image=new Image();
            kati_image.src="../images/omocha/syuukun_card/syouhai300_kati.png";
            var make_image=new Image();
            make_image.src="../images/omocha/syuukun_card/syouhai300_make.png";

            var card_syuukun=new Image();
            card_syuukun.src="../images/omocha/syuukun_card/card_syuukun130200.png";
            var kinkyuujitai5_image=new Image();
            kinkyuujitai5_image.src="../images/omocha/syuukun_card/kinkyuujitai5.png";
            var ryuunoitigeki_img=new Image();
            ryuunoitigeki_img.src="../images/omocha/syuukun_card/ryuunoitigeki.png";

            var tehuda32=new Image();
            tehuda32.src="../images/omocha/syuukun_card/tehuda32.png";

            //ã“ã“ã«ã‚²ãƒ¼ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç½®ãã¨ã‚¤ã‚¤ãƒã€‚
            var my_deck=[];
                //my_deck[i]={card:test_card,ATK:1,HP:1,state:[],position:"my_yamahuda",can_ATK:0};
            var teki_deck=[];
            var my_yamahuda=[];
            var teki_yamahuda=[];
            var my_tehuda=[];
            var teki_tehuda=[];
            var my_ba=["","","","",""];
            /*
                my_ba[i]=my_deck[i+5];
                my_ba[i].position="my_ba_"+i;
                my_ba[i].can_ATK=1;
            */

            var teki_ba=["","","","",""];
            var death_my_ba=["","","","",""];//æ­»äº¡æ™‚æ¼”å‡ºã®ãŸã‚ã«ã‚«ãƒ¼ãƒ‰ã‚’åˆ¥ã®å ´æ‰€ã«ç§»ã—ãŸã„ï¼ˆå ´ã«æ®‹ã™ã¨ãƒã‚°ã®æ¸©åºŠã«ãªã‚‹ã“ã¨ã¯è‡ªæ˜ãªã®ã§ï¼‰
            var death_teki_ba=["","","","",""];
            var tukau_mahou=[];//é­”æ³•ã¤ã‹ã£ãŸç¬é–“ã«æ¶ˆãˆã‚‹ã®ã‚ˆããªã„ã¨æ€ã£ãŸã€‚
            
            var my_haka=[];
            var teki_haka=[];
            //ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãªã©ã€ã‚·ã‚¹ãƒ†ãƒ ã®ã€ã‚ã®ã€ã‚¢ãƒ¬ã€ã‚¢ãƒ¬ã•ï¼
            var key_input="";
            var what_input="";//ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰åŒæ™‚ãŠã—ã«ä½¿ã†
            var key_interval=0;//n*10[s]ã€€é•·æŠ¼ã—ã®é€£ç¶šå…¥åŠ›ã«ä½¿ã£ã¦ã‚‹
            var key_owarasete=0;
            var é•·æŠ¼ã—é˜»æ­¢=0;//æ±ºå®šãƒœã‚¿ãƒ³ã‚’é•·æŠ¼ã—é€£æ‰“ã™ã‚‹ã®ã¯ã¾ãšã„ã®ã§ã¯ï¼Ÿã¨ãªã£ãŸã®ã§é˜»æ­¢ã—ã¾ã™ã€‚

            var cursor=16;
            var pre_cursor;
            var ba_haiti=[2,1,3,0,4];
            var cursor2=0;

            var duel_phase="è‡ªç”±";
            var aite_phase=0;//ç›¸æ‰‹ã®ã‚¿ãƒ¼ãƒ³ã«å‹•ã‹ã—ãŸã„ã€‚
            var aite_nayami;//ç›¸æ‰‹ã‚¿ãƒ¼ãƒ³ã®æ‚©ã¿ãƒ•ã‚§ãƒ¼ã‚ºã«ä½¿ã†ãªã‚“ã‹ç”¨é€”ä¸æ˜ã®å¤‰æ•°ã ï¼
            var aite_delay=0;//ãŠå‰é«˜é€Ÿã§å‹•ãã™ãï¼

            var atk_card;
            var def_card;
            var tukau_card_num;

            var syousai_card;
            var syousai_state;
            var syousai_state_color;

            var my_kougeki_sum=0;//AIç”¨
            var teki_kougeki_sum=0;//é™å‚ã«ã‚‚ä½¿ã£ã¦ã‚‹

            var tehuda_maisuu=0;//æ‰‹æœ­ã®è§’åº¦è¦šãˆã‚‹ã®ã«ä½¿ã£ã¦ã‚‹
            var card_kankaku=0;
            var kakudo=10;

            var zuba=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]//zuba64ã‚’è¡¨ç¤ºã™ã‚‹ã‚¿ã‚¤ãƒãƒ¼
            var yamahuda_damage=[0,0];//å·¦ãŒä¿ºã¸ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ã§ã€å³ãŒç›¸æ‰‹ã¸ã®ãƒ€ãƒ¡ãƒ¼ã‚¸æå†™

            var time=0;

            onload = function(){
                onload_functions();
                const cnvs = document.getElementById('cnvs');//IDã‚’æŒ‡å®šã—ã¦å¤‰æ•°ã«ã¶ã¡è¾¼ã‚€
                const ctx = cnvs.getContext("2d");
                ctx.font = "50px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚

                if (navigator.userAgent.match(/iPhone|Android.+Mobile/)) {//è²´æ§˜ï¼ã‚¹ãƒãƒ›ã§è¦‹ã¦ã„ã‚‹ãªï¼ï¼Ÿ
                    cnvs.style.width=100+"%";
                    cnvs.style.height=cnvs.clientWidth+"px";
                }

                var buttons = document.getElementsByClassName("key_button");//ãƒœã‚¿ãƒ³æ“ä½œ
                if( window.ontouchstart === null ){ // æ³¨ï¼šontouchstartãŒå­˜åœ¨ã—ãªã„æ™‚ã¯ undefined ãŒè¿”ã‚‹
                    //ã‚ˆã†ã™ã‚‹ã«ã‚¿ãƒƒãƒæ©Ÿèƒ½ãŒã‚ã‚‹ç«¯æœ«ãªã‚‰
                    for(let i=0;i<buttons.length;i++){
                        buttons[i].addEventListener("touchstart",function(e){//æŠ¼ã™ã¨å‹•ã
                            e.preventDefault();//ãƒœã‚¿ãƒ³ã‚’ã‚‚ã¨ã®çŠ¶æ…‹ã«æˆ»ã—ã¦ãã ã•ã„ï¼ˆè¡€æ¶™ï¼‰
                            key_input=this.value;
                            key_interval=-1;//åˆå›é™å®šãƒ¢ãƒ¼ãƒ‰ï¼ˆ1å›ã¯å‹•ä½œã•ã›ãŸã„ã®ã§ã€‚ï¼‰
                            key_owarasete=0;
                        });
                        buttons[i].addEventListener("touchend",function(e){//é›¢ã™ã¨å‹•ã
                            e.preventDefault();//ãƒœã‚¿ãƒ³ã‚’ã‚‚ã¨ã®çŠ¶æ…‹ã«æˆ»ã—ã¦ãã ã•ã„ï¼ˆè¡€æ¶™ï¼‰
                            if(key_interval!=-1){//ä¸€å›ã‚‚å®Ÿè¡Œã•ã‚Œã¦ãªã„ã®ã«çµ‚äº†ã™ã‚‹ã®ã¯ãƒœã‚¿ãƒ³ã¨ã—ã¦ãŠã‹ã—ã„ã®ã§ã€ã¯ã˜ã
                                key_input="";
                                key_interval=0;//é•·æŠ¼ã—ã®é€£ç¶šå…¥åŠ›ã«ä½¿ã£ã¦ã‚‹ã ã‘ãªã®ã§é•·æŠ¼ã—ãŒçµ‚ã‚ã£ãŸã‚‰åˆæœŸåŒ–ã™ã‚‹ã‚“ã‚ˆ
                            }else{
                                key_owarasete=1;//ä¸€åº¦ã‚‚å®Ÿè¡Œã•ã‚Œã¦ãªã„ã‘ã©ã€ãƒœã‚¿ãƒ³ã¯ã‚‚ã†æŠ¼ã—ã¦ãªã„ã®ã‚ˆã€‚
                            }
                        });
                    }
                }else{
                    //ä¸€èˆ¬çš„ãªPCãªã‚‰
                    for(let i=0;i<buttons.length;i++){
                        buttons[i].addEventListener("mousedown",function(){//æŠ¼ã™ã¨å‹•ã
                            key_input=this.value;
                            key_interval=-1;//åˆå›é™å®šãƒ¢ãƒ¼ãƒ‰ï¼ˆ1å›ã¯å‹•ä½œã•ã›ãŸã„ã®ã§ã€‚ï¼‰
                            key_owarasete=0;
                        });
                        buttons[i].addEventListener("mouseup",function(){//é›¢ã™ã¨å‹•ã
                            if(key_interval!=-1){//ä¸€å›ã‚‚å®Ÿè¡Œã•ã‚Œã¦ãªã„ã®ã«çµ‚äº†ã™ã‚‹ã®ã¯ãƒœã‚¿ãƒ³ã¨ã—ã¦ãŠã‹ã—ã„ã®ã§ã€ã¯ã˜ã
                                key_input="";
                                key_interval=0;//é•·æŠ¼ã—ã®é€£ç¶šå…¥åŠ›ã«ä½¿ã£ã¦ã‚‹ã ã‘ãªã®ã§é•·æŠ¼ã—ãŒçµ‚ã‚ã£ãŸã‚‰åˆæœŸåŒ–ã™ã‚‹ã‚“ã‚ˆ
                            }else{
                                key_owarasete=1;//ä¸€åº¦ã‚‚å®Ÿè¡Œã•ã‚Œã¦ãªã„ã‘ã©ã€ãƒœã‚¿ãƒ³ã¯ã‚‚ã†æŠ¼ã—ã¦ãªã„ã®ã‚ˆã€‚
                            }
                        });

                    }
                }
                
                document.addEventListener('keydown', function(key){//ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ

                    what_input="";
                    if(key.key=="w" || key.key=="k" || key.key=="ArrowUp"){
                        what_input="â†‘";
                    }else if(key.key=="a" || key.key=="h" || key.key=="ArrowLeft"){
                        what_input="â†";
                    }else if(key.key=="d" || key.key=="l" || key.key=="ArrowRight"){
                        what_input="â†’";
                    }else if(key.key=="s" || key.key=="j" || key.key=="ArrowDown"){
                        what_input="â†“";
                    }else if(key.key=="Enter"){
                        what_input="ã€‡";
                    }else if(key.key=="Shift"){
                        what_input="Ã—";
                    }
                    if(key_input.indexOf(what_input)==-1){//ã™ã§ã«æŠ¼ã•ã‚Œã¦ã„ãŸã‚‰ã€æ–‡å­—åˆ—æ¤œç´¢ã§ã²ã£ã‹ã‹ã‚‹ã€‚ã²ã£ã‹ã‹ã‚‰ãªã„ãªã‚‰-1ãŒå¸°ã£ã¦ãã‚‹
                        key_input=key_input+what_input;//ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã¯åŒæ™‚æŠ¼ã—ãŒå¯èƒ½ãªã®ã§æ›¸ãæ›ãˆã§ã¯ãªãã€è¿½åŠ ã«ã—ã¾ã™ã€‚ãˆï¼Ÿã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã¨ãƒœã‚¿ãƒ³åŒæ™‚æŠ¼ã—ã•ã‚ŒãŸã‚‰ï¼Ÿãƒï½ã‚«
                    }
                    if (what_input != ""){key.preventDefault();}//çŸ¢å°ã‚­ãƒ¼ã§ã®æ“ä½œæ™‚ã«ã€ç”»é¢ãŒä¸Šä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã—ã¾ã†ã“ã¨ã‚’é˜²ã

                    
                });
                document.addEventListener('keyup', function(key){//ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ
                    what_input="";
                    if(key.key=="w" || key.key=="ArrowUp"){
                        what_input="â†‘";
                    }else if(key.key=="a" || key.key=="ArrowLeft"){
                        what_input="â†";
                    }else if(key.key=="d" || key.key=="ArrowRight"){
                        what_input="â†’";
                    }else if(key.key=="s" || key.key=="ArrowDown"){
                        what_input="â†“";
                    }else if(key.key=="Enter"){
                        what_input="ã€‡";
                    }else if(key.key=="Shift"){
                        what_input="Ã—";
                    }
                    
                    key_input=key_input.slice(0,key_input.indexOf(what_input))+key_input.slice(key_input.indexOf(what_input)+1);//è©²å½“æ–‡å­—ã‚’æ¶ˆå»
                    if(key_input==""){
                        key_interval=0;//é•·æŠ¼ã—ã®é€£ç¶šå…¥åŠ›ã«ä½¿ã£ã¦ã‚‹ã ã‘ãªã®ã§é•·æŠ¼ã—ãŒçµ‚ã‚ã£ãŸã‚‰åˆæœŸåŒ–ã™ã‚‹ã‚“ã‚ˆ
                    }
                });

                function card_draw(print_card,x,y,of_y=0){
                    ctx.drawImage(print_card.card.image,x,y+of_y);
                    
                    if(print_card.state.indexOf("TOP_ACE")!=-1){
                        ctx.fillStyle="rgb(255,0,0,1)";
                        ctx.fillRect(x-2,y+of_y,5,200);
                        ctx.fillRect(x+128,y+of_y,5,200);
                        ctx.fillRect(x,y+of_y,133,5);
                        ctx.fillRect(x,y+of_y+195,133,5);
                    }
                    if(print_card.state.indexOf("ACE")!=-1){
                        ctx.fillStyle="rgb(255,255,0)";
                        ctx.fillRect(x-2,y+of_y,5,200);
                        ctx.fillRect(x+128,y+of_y,5,200);
                        ctx.fillRect(x,y+of_y,133,5);
                        ctx.fillRect(x,y+195+of_y,133,5);
                    }
                    if(print_card.state.indexOf("ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼")!=-1){
                        ctx.drawImage(atk_plate,x,y+104+of_y);
                        ctx.drawImage(def_plate,x,y+152+of_y);
                        ctx.font = "40px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(255,255,255)";
                        if(print_card.ATK<10){
                            ctx.fillText(print_card.ATK, x+13, y+146+of_y);
                        }else{
                            ctx.fillText(print_card.ATK, x+3, y+146+of_y);
                        }
                        if(print_card.HP<10){
                            ctx.fillText(print_card.HP, x+13, y+188+of_y);
                        }else{
                            ctx.fillText(print_card.HP, x+3, y+188+of_y);
                        }
                        if(print_card.can_ATK!=0){//æ”»æ’ƒå¯èƒ½ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã«ã¯ãƒãƒ¼ã‚¯ã‚’è¡¨ç¤ºã€è¤‡æ•°æ”»æ’ƒãƒãƒ³ãŒå®Ÿè£…ã•ã‚ŒãŸã‚‰å¤‰æ›´ã—ã¦ã¡ã‚‡
                            ctx.drawImage(atk_circle,x+10+10*Math.sin(time*Math.PI/64),y+20+8*Math.sin(time*Math.PI/16)+of_y);
                        }
                    }else{//é­”æ³•ã˜ã‚ƒã‚“ï¼ˆã»ã‚“ã¾ã‹ï¼Ÿï¼‰
                        ctx.fillStyle="rgb(0,200,0)";
                        ctx.fillRect(x-2,y+of_y,5,200);
                        ctx.fillRect(x+128,y+of_y,5,200);
                        ctx.fillRect(x,y+of_y,133,5);
                        ctx.fillRect(x,y+195+of_y,133,5);
                    }
                    
                    
                }
                function death_card(shi_card,haka,doko){
                    if(haka==teki_haka){
                        shi_card.position="teki_haka";
                        death_teki_ba[doko]=shi_card;
                        death_teki_ba[doko].move=10;
                    }else{
                        shi_card.position="my_haka";
                        death_my_ba[doko]=shi_card;
                        death_my_ba[doko].move=10;
                    }

                    shi_card.HP=shi_card.card.HP;//å›å¾©
                    //shi_card.state=shi_card.card.state;
                    shi_card.can_ATK=0;//æ”»æ’ƒä¸å¯
                    
                    haka.push(shi_card);//GOå¢“å ´â€¦ãªã‚“ã§ã“ã“ã ã‘pushä½¿ã£ã¦ã‚‹ã‚“ã ã‚
                    
                    return "";//å ´ã‹ã‚‰é™¤å»ã™ã‚‹ãŸã‚ã«ã“ã„ã¤ã‚’ba_i[n]ã«ä»£å…¥ã—ã¦ãŠã„ã¦ãã‚Œã€‚
                    
                }
                function deck_initialize(list,deck,yamahuda){
                    //my_deck[i]={card:test_card,ATK:1,HP:1,state:[],position:"my_yamahuda",can_ATK:0};
                    var doko_position;
                    var doko_syoukan;
                    var ba;
                    if(deck==my_deck){
                        doko_position="my_yamahuda";//è‡ªãƒ‡ãƒƒã‚­ã®åˆæœŸåŒ–ãªã‚‰è‡ªåˆ†ã®å±±æœ­ã«å…¥ã‚Œã¦ã­
                        doko_syoukan="my_ba_";
                        ba=my_ba;
                    }else{
                        doko_position="teki_yamahuda";//æ•µã ã­ã€‚
                        doko_syoukan="teki_ba_";
                        ba=teki_ba;
                    }
                    var nani_card;
                    var imano_num;
                    var swap;
                    var ACE;
                    imano_num=0;

                    for(let i=0;i<list.card_list.length;i++){
                        nani_card=list.card_list[i][0];//ã“ã®ã‚«ãƒ¼ãƒ‰næšå±±æœ­ã«å…¥ã‚Œã‚‹ãœï¼
                        for(let j=0;j<list.card_list[i][1];j++){
                            deck[imano_num]={card:nani_card};//ã“ã“ã ã‘æãæ–¹ãŒé•ã†ã®ã¯ãªã€ã—ã‹ãŸãªã„ã‚“ã‚„ãªã£ã¦
                            deck[imano_num].ATK=nani_card.ATK;
                            deck[imano_num].HP=nani_card.HP;
                            deck[imano_num].state=nani_card.state.slice();//sliceã‚’ã¤ã‘ã‚‹ã“ã¨ã§å‚ç…§æ¸¡ã—ã‚’ã‚„ã‚ã•ã›ã¦å€¤æ¸¡ã—ã‚’è¡Œã‚ã›ã¦ã„ã¾ã™
                            deck[imano_num].position=doko_position;
                            deck[imano_num].can_ATK=0;//ã“ã‚Œã¯æ”»æ’ƒå¯èƒ½ã‹ã©ã†ã‹ã‚’æ„å‘³ã™ã‚‹ãï¼å±±æœ­ã‹ã‚‰æ”»æ’ƒã—ãªã„ã§ãã‚Œã‚ˆãªï¼ï¼ˆã„ã‚„ã€ã§ãã‚‹ã‚„ã¤ãŒã„ãšã‚Œã§ã‚‹ã‹ã‚‚ã—ã‚Œã‚“ãŒï¼‰
                            yamahuda[imano_num]=deck[imano_num];//ã¨ã‚Šã‚ãˆãšå…¨éƒ¨å±±æœ­ã«ã¶ã¡ã“ã‚“ã§ã‚„ã‚‹ãœï½ï¼
                            imano_num+=1;
                        }
                    }
                    
                    ACE=list.TOP_ACE;
                    for(let i=0;i<yamahuda.length;i++){//TOP_ACEã‚’å¬å–šâ€¦TOP_ACEã¯5æšä»¥ä¸‹ã§ãŠã­ãŒã—ã¾ã™
                        for(let j=0;j<ACE.length;j++){
                            if(yamahuda[i].card==ACE[j]){//TOPãŒã„ã£ã±ã„ã„ã‚‹ã‹ã‚‚ï¼ï¼Ÿ
                                yamahuda[i].state[yamahuda[i].state.length]="TOP_ACE";
                                ba[ba_haiti[ACE.length-1]]=yamahuda[i];
                                ba[ba_haiti[ACE.length-1]].position=doko_syoukan+ba_haiti[ACE.length-1];
                                ba[ba_haiti[ACE.length-1]].can_ATK=1;//å¬å–šæ™‚åŠ¹æœã«ã‚ˆã£ã¦ã¯å¤‰ã‚ã‚‹ã‹ã‚‚ã­
                                ba[ba_haiti[ACE.length-1]].move=5;
                                ACE.splice(j,1);
                                yamahuda.splice(i,1);//å¬å–šã—ãŸã®ã§å±±æœ­æ¸›ã‚Šã¾ã™ã€‚
                                i-=1;//å ´ã«å‡ºã—ã¦æ¶ˆãˆãŸã®ã§
                                break;
                            }
                        }
                        if(ACE.length==0){
                            break;
                        }
                    }

                    ACE=list.ACE;
                    for(let i=0;i<yamahuda.length;i++){//ACEã«ACEstateã‚’ã‚ã’ã‚‹
                        for(let j=0;j<ACE.length;j++){
                            if(yamahuda[i].card==ACE[j]){
                                yamahuda[i].state[yamahuda[i].state.length]="ACE";
                                ACE.splice(j,1);
                                break;
                            }
                        }
                        if(ACE.length==0){
                            break;
                        }
                    }
                    //ã“ã“ã§ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã™ã¹ãã‚ˆï¼ãã†ã ã‚ï¼ã€€â†’Fisher-Yates shuffleã¨ã„ã†ã‚‰ã—ã„
                    for(let i=yamahuda.length-1;i>0;i--){//ãƒ‡ãƒƒã‚­ã®ã‚±ãƒ„ã‹ã‚‰â€¦
                        var j = Math.floor(Math.random() * (i + 1));//ã‚±ãƒ„ä»¥ä¸‹ã®ç•ªå·ã®æœ­ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã³
                        swap =yamahuda[i];//iã¨jã§ã‚¹ãƒ¯ãƒƒãƒ—ã™ã‚‹ã€‚
                        yamahuda[i]=yamahuda[j];
                        yamahuda[j]=swap;
                    }
                }
                function pull_card(yamahuda,tehuda=undefined,maisuu){
                    if(yamahuda.length<maisuu){
                        maisuu=yamahuda.length;//å±±æœ­ã«ã‚«ãƒ¼ãƒ‰ãŒãªã„ã®ã«å¼•ãã‚“ã˜ã‚ƒãªã„
                    }
                    if(yamahuda==my_yamahuda){//è‡ªãƒ‡ãƒƒã‚­ã®åˆæœŸåŒ–ãªã‚‰è‡ªåˆ†ã®å±±æœ­ã«å…¥ã‚Œã¦ã­
                        for(let i=0;i<maisuu;i++){
                            tehuda[tehuda.length]=yamahuda[yamahuda.length-1];
                            tehuda[tehuda.length-1].position="my_tehuda_"+(tehuda.length-1+i);
                            yamahuda.splice(-1,1);//ãƒ‰ãƒ­ãƒ¼ã—ãŸã®ã§å±±æœ­æ¸›ã‚Šã¾ã™ã€‚
                        }
                    }else{//æ•µã ã­ã€‚
                        for(let i=0;i<maisuu;i++){
                            tehuda[tehuda.length]=yamahuda[yamahuda.length-1];
                            tehuda[tehuda.length-1].position="teki_tehuda_"+(tehuda.length-1+i);
                            yamahuda.splice(-1,1);//ãƒ‰ãƒ­ãƒ¼ã—ãŸã®ã§å±±æœ­æ¸›ã‚Šã¾ã™ã€‚
                        }
                    }
                    
                    
                }
                function atk_yamahuda(atk,yamahuda,haka,ba,tehuda){
                    var doko_haka;
                    var dare_kati;
                    var doko_syoukan;
                    var doko_tehuda;
                    var dare_yamahuda_damage;
                    if(yamahuda==teki_yamahuda){//æ•µã¸ã®æ”»æ’ƒã•ï¼
                        dare_kati="ä¿ºå‹ã¡";                          
                        doko_haka="teki_haka";
                        doko_syoukan="teki_ba_";
                        doko_tehuda="teki_tehuda_";
                        dare_yamahuda_damage=yamahuda_damage[1];
                    }else{
                        dare_kati="æ•µå‹ã¡";                          
                        doko_haka="my_haka";
                        doko_syoukan="my_ba_";
                        doko_tehuda="my_tehuda_";
                        dare_yamahuda_damage=yamahuda_damage[0];
                    }
                    dare_yamahuda_damage+=atk;
                    if(atk>yamahuda.length){//ã¯ã„æ­»äº¡ï½ï¼æ”»æ’ƒã•ã‚ŒãŸå´ã®è² ã‘ğŸ‘
                        atk=yamahuda.length;
                        dare_yamahuda_damage=atk;
                        duel_phase=dare_kati;
                    }
                    for(let i=0;i<atk;i++){
                        if(yamahuda[yamahuda.length-1].state.indexOf("ACE")!=-1 || yamahuda[yamahuda.length-1].state.indexOf("TOP_ACE")!=-1){//ACEãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼æ¥ãŸï¼
                            for(let j=0;j<5;j++){
                                if(ba[ba_haiti[j]]==""){
                                    ba[ba_haiti[j]]=syoukan(yamahuda[yamahuda.length-1],doko_syoukan+ba_haiti[j]);
                                    break;
                                }
                                if(j==4){//å¬å–šã§ããªã‹ã£ãŸï¼ˆç¬‘ï¼‰â†’æ‰‹æœ­ã¸
                                    tehuda[tehuda.length]=yamahuda[yamahuda.length-1];
                                    tehuda[tehuda.length-1].position=doko_tehuda+(tehuda.length-1+i);
                                }
                            }
                            
                            if(dare_kati=="ä¿ºå‹ã¡"){
                                duel_phase="è‡ªç”±";//æœ€å¾Œã®ç ¦ãŒå¬å–šã•ã‚ŒãŸã®ã§å‹ã¡ã‚’å–ã‚Šæ¶ˆã—ã¦ã‚¿ãƒ¼ãƒ³ç¶šè¡Œ
                            }else{
                                duel_phase="ç›¸æ‰‹";
                            }
                            
                        }else{
                            haka[haka.length]=yamahuda[yamahuda.length-1];
                            haka[haka.length-1].position=doko_haka;
                        }
                        
                        yamahuda.splice(-1,1);
                    }
                }
                function ba_mons_num(ba){
                    var num_of_mons;
                    num_of_mons=0;
                    for(let i=0;i<5;i++){
                        if(ba[i]!=""){
                            num_of_mons+=1;
                        }
                    }
                    return num_of_mons;
                }
                function text_kaigyou_hyouji(txt,x,y,x_haba,y_haba,moji_zenkaku,iro=[]){//ãƒ†ã‚­ã‚¹ãƒˆã‚’canvasã§ã‚‚æ”¹è¡Œã—ã¦ãã‚Œã‚‹ã‚“ã‚„ï¼
                    var txt_array;
                    var past_i;
                    var moji_x;
                    var moji_count;
                    var moji_color;
                    var color_count;
                    var iro_count;
                    txt_array=[];
                    past_i=0;
                    moji_count=0;
                    color_count=-1;
                    iro_count=0;
                    moji_color=ctx.fillStyle;
                    ctx.font = moji_zenkaku+"px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚
                    for (let i=0; i<txt.length; i++){
                        if(ctx.measureText(txt.substr(past_i,i-past_i+2)).width > x_haba){
                            txt_array[txt_array.length]=txt.substr(past_i,i-past_i+1);
                            past_i=i+1;
                        }
                    }
                    if(past_i!=txt.length){//åˆ‡ã‚Šå–ã‚Šä½™ã£ã¦ã¾ã™ã‚ˆ
                        txt_array[txt_array.length]=txt.substr(past_i);
                    }
                    if(txt_array.length+1>Math.floor(y_haba/moji_zenkaku)){//ç¸¦ã«ã¯ã¿å‡ºã—ã¦ã‚‹ã
                        text_kaigyou_hyouji(txt,x,y,x_haba,y_haba,moji_zenkaku-1,iro);//ã¡ã‚‡ã£ã¨å°ã•ããªã£ã¦ã‚„ã‚ŠãªãŠã—ã¦ã“ã„
                    }else{
                        if(iro==""){//è‰²ã¬ã‚Šã—ãªã„
                            for (let i=0; i<txt_array.length; i++){
                                    ctx.fillText(txt_array[i], x, y+(i+1)*moji_zenkaku);//æ–‡å­—ã‚’è¡¨ç¤ºã—ã¦ã„ããœãƒ¼ï¼
                            }
                        }else{
                            //è‰²ã‚’å¡—ã‚ŠãŸã„ã¨ã„ã†æ°—æŒã¡ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ
                            //iro[[è‰²å¤‰ãˆã¯ã˜ã‚,å¡—ã‚‹æ–‡å­—æ•°,"rgb( , , )"],[],[],...] 
                            iro[iro.length]=[0,0,"çµ‚ã‚ã‚Š"];
                            for (let i=0; i<txt_array.length; i++){
                                moji_x=0;
                                for(let j=0;j<txt_array[i].length;j++){
                                    
                                    if(moji_count==iro[iro_count][0]){
                                        color_count=iro[iro_count][1];
                                        ctx.fillStyle=iro[iro_count][2];
                                        iro_count+=1;
                                    }
                                        
                                    if(color_count>=1){
                                        color_count-=1;
                                    }else if(color_count==0){
                                        color_count-=1;
                                        ctx.fillStyle=moji_color;//è‰²æˆ»ã—ã¦
                                    }
                                    ctx.fillText(txt_array[i][j], x+moji_x, y+(i+1)*moji_zenkaku);//æ–‡å­—ã‚’è¡¨ç¤ºã—ã¦ã„ããœãƒ¼!(1æ–‡å­—ãšã¤)
                                    moji_x+=ctx.measureText(txt_array[i][j]).width;
                                    moji_count+=1;
                                }
                            }
                        }
                        ctx.fillStyle=moji_color;//è‰²æˆ»ã—ã¦
                    }
                }
                function takusan_card_draw(card,x,y,x_haba,y_haba){
                    var kakudai;
                    var x_maisuu;
                    kakudai=1;
                    while(card.length>Math.floor(x_haba/(kakudai*140))*Math.floor(y_haba/(kakudai*210))){//æ‹¡å¤§ç‡ã‚’ä¸‹ã’ã¦ã‚«ãƒ¼ãƒ‰ãŒå…¨éƒ¨æ ã«å…¥ã‚‹ã‚ˆã†ã«èª¿æ•´ã™ã‚‹
                        kakudai-=0.05;
                    }
                    x_maisuu=Math.floor(x_haba/(kakudai*140));
                    ctx.save();
                    ctx.scale(kakudai,kakudai);
                    for(let i=0;i<card.length;i++){
                        card_draw(card[i],x/kakudai+140*(i%x_maisuu),y/kakudai+210*(Math.floor(i/x_maisuu)));
                    }
                    ctx.restore();
                }
                function syoukan(card,ba_name){
                    var ba
                    ba=card;
                    ba.position=ba_name;
                    ba.can_ATK=1;//å¬å–šæ™‚åŠ¹æœã«ã‚ˆã£ã¦ã¯å¤‰ã‚ã‚‹ã‹ã‚‚ã­
                    ba.move=5;
                    return ba;
                }
                //ã‚«ãƒ¼ãƒ‰å®šç¾©ãƒ¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ãƒ¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
                //effectã‚’ä½¿ã†ã¨ãã¯effect()
                //å ´æ‰€æ‚ªããªã„ï¼Ÿâ†’ã ã£ã¦ã‚«ãƒ¼ãƒ‰å†…ã«é–¢æ•°ä½¿ã„ãŸã‹ã£ãŸã‚“ã ã‚‚ã‚“â€¦
                var test_card={name:"ãƒ†ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰",image:test,ATK:1,HP:1,state:["ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼","test"],effect_req:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){return false;},effect:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){console.log("name:"+this.name);},AI:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){return true;},text:"ã‚ªã‚¤ãƒ©ã¯ãƒ†ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰ï¼çœŸã£èµ¤ãªèµ¤è‰²ãŒãƒˆãƒ¬ãƒ¼ãƒ‰ãƒãƒ¼ã‚¯ã•ï¼â€¦ã¨ã“ã‚ã§ä¿ºãŒã‚ã¡ã‚ƒãã¡ã‚ƒé•·ã„èª¬æ˜æ–‡ã‚’æŒã£ã¦ãŸã¨ã—ãŸã‚‰ã©ã†ã™ã‚‹ï¼Ÿãã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’ã’",text_iro:[]};
                var test_card2={name:"ãƒ†ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰2",image:test_syuukun,ATK:3,HP:4,state:["ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼","test"],effect_req:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){return false;},effect:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){console.log("name:"+this.name);},AI:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){return true;},text:"ä¼èª¬ã®ãƒ†ã‚¹ãƒˆã—ã‚…ã†ãã‚“ã€‚ã‚ã€ã¾ã£ã¦åŠè§’æ–‡å­—ã®ãƒ†ã‚¹ãƒˆã—ãŸã„123456789aqswderfï¾ï½²ï¾ï½²ï¾ï½²ï¾„ï¾ï½³ï¾…ï¾ï¾€ï¾ï½²ï¾ï½²ï¾ï½²â€¦ã„ã‘ã‚‹ã˜ã‚ƒã‚“ï¼",text_iro:[[0,1,"rgb(255,0,0)"],[1,1,"rgb(255,255,0)"],[2,1,"rgb(0,255,0)"],[3,1,"rgb(0,255,255)"],[4,1,"rgb(0,0,255)"],[5,1,"rgb(255,0,255)"],[6,1,"rgb(255,0,0)"],[7,1,"rgb(255,255,0)"],[8,1,"rgb(0,255,0)"],[9,1,"rgb(0,255,255)"],[10,1,"rgb(0,0,255)"]]};
                
                var syuukun={name:"ã—ã‚…ã†ãã‚“",image:card_syuukun,ATK:3,HP:10,state:["ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼","ã—ã‚…ã†ãã‚“"],effect_req:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){return false;},effect:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){console.log("name:"+this.name);},AI:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){return true;},text:"ã‚«ãƒ¼ãƒ‰ã«åŠ›ã‚’è¾¼ã‚ã‚ï¼",text_iro:[[4,1,"rgb(255,0,0)"]]};
                var kinkyuujitai5={name:"ç·Šæ€¥äº‹æ…‹â”€ï¼•â”€",image:kinkyuujitai5_image,state:["é­”æ³•","è¶…å±é™º"],effect_req:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){
                    if(ã‚¿ã‚¤ãƒŸãƒ³ã‚°=="æ‰‹æœ­ã‹ã‚‰"){
                        for(let i=0;i<5;i++){//ç ´å£Šå¯èƒ½å¯¾è±¡ãŒã„ã‚‹ãªã‚‰ç™ºå‹•å¯èƒ½ã€‚
                            if(my_ba[i]!="" && my_ba[i].state.indexOf("TOP_ACE")==-1 && my_ba[i].state.indexOf("ACE")==-1){
                                return true; 
                            }
                            if(teki_ba[i]!="" && teki_ba[i].state.indexOf("TOP_ACE")==-1 && teki_ba[i].state.indexOf("ACE")==-1){
                                return true; 
                            }
                        }
                        return false;  
                    }else{
                        return false;  
                    }
                      
                },effect:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){
                    if(ã‚¿ã‚¤ãƒŸãƒ³ã‚°=="æ‰‹æœ­ã‹ã‚‰"){
                        for(let i=0;i<5;i++){
                            if(my_ba[i]!="" && my_ba[i].state.indexOf("TOP_ACE")==-1 && my_ba[i].state.indexOf("ACE")==-1){
                                my_ba[i]=death_card(my_ba[i],my_haka,i);
                            }
                            if(teki_ba[i]!="" && teki_ba[i].state.indexOf("TOP_ACE")==-1 && teki_ba[i].state.indexOf("ACE")==-1){
                                teki_ba[i]=death_card(teki_ba[i],teki_haka,i);
                            }
                        }
                    }
                },AI:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){
                    if(ã‚¿ã‚¤ãƒŸãƒ³ã‚°=="æ‰‹æœ­ã‹ã‚‰"){
                        my_kougeki_sum=0;
                        teki_kougeki_sum=0;
                        for(let i=0;i<5;i++){
                            if(my_ba[i]!="" && my_ba[i].state.indexOf("ACE")==-1 && my_ba[i].state.indexOf("TOP_ACE")==-1){//zakoãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã ã­
                                my_kougeki_sum+=my_ba[i].ATK;
                            }
                            if(teki_ba[i]!="" && teki_ba[i].state.indexOf("TOP_ACE")==-1 && teki_ba[i].state.indexOf("ACE")==-1){//zakoãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã ã­
                                teki_kougeki_sum+=teki_ba[i].ATK;
                            }
                        }
                        if(my_kougeki_sum>teki_kougeki_sum){//ç™ºå‹•æ¡ä»¶ã–ã¤ã™ãã‚“ï¼Ÿ
                            return true;
                        }
                        return false; 
                    }
                },text:"äº‹æ•…ç™ºç”Ÿã€ç·Šæ€¥äº‹æ…‹â”€ï¼•â”€TOP_ACE ACE ã§ãªã‘ã‚Œã°ç”Ÿãæ®‹ã‚Œãªã„ã€‚ï¼ˆå…¨ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ç ´å£Šï¼‰",text_iro:[[12,7,"rgb(255,0,0)"],[20,3,"rgb(200,200,0)"]]};
                var ryuunoitigeki={name:"é¾ã®ä¸€æ’ƒ",image:ryuunoitigeki_img,state:["é­”æ³•","æ•µé¸æŠ"],effect_req:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){
                    if(ã‚¿ã‚¤ãƒŸãƒ³ã‚°=="æ‰‹æœ­ã‹ã‚‰"){
                        if(duel_phase!="ç›¸æ‰‹"){
                            for(let i=0;i<5;i++){//ç ´å£Šå¯èƒ½å¯¾è±¡ãŒã„ã‚‹ãªã‚‰ç™ºå‹•å¯èƒ½ã€‚
                                if(teki_ba[i]!="" && teki_ba[i].state.indexOf("TOP_ACE")==-1 && teki_ba[i].state.indexOf("ACE")==-1){
                                    return true; 
                                }
                            }
                        }else{
                            for(let i=0;i<5;i++){//ç ´å£Šå¯èƒ½å¯¾è±¡ãŒã„ã‚‹ãªã‚‰ç™ºå‹•å¯èƒ½ã€‚
                                if(my_ba[i]!="" && my_ba[i].state.indexOf("TOP_ACE")==-1 && my_ba[i].state.indexOf("ACE")==-1){
                                    return true; 
                                }
                            }
                        }
                        return false;  
                    }else{
                        return false;  
                    }  
                },effect:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){
                    if(ã‚¿ã‚¤ãƒŸãƒ³ã‚°=="æ‰‹æœ­ã‹ã‚‰"){
                        if(duel_phase!="ç›¸æ‰‹"){
                            if(teki_ba[cursor2]!="" && teki_ba[cursor2].state.indexOf("TOP_ACE")==-1 && teki_ba[cursor2].state.indexOf("ACE")==-1){
                                teki_ba[cursor2]=death_card(teki_ba[cursor2],teki_haka,cursor2);
                                return true; 
                            }
                            return false; 
                        }else{
                            var ä¸€ç•ªå¼·ã„ã‚«ãƒ¼ãƒ‰ã®æ•°å€¤=0;
                            for(let i=0;i<5;i++){
                                if(my_ba[i]!="" && my_ba[i].state.indexOf("TOP_ACE")==-1 && my_ba[i].state.indexOf("ACE")==-1){//ç ´å£Šå¯èƒ½å¯¾è±¡
                                    if(ä¸€ç•ªå¼·ã„ã‚«ãƒ¼ãƒ‰ã®æ•°å€¤<my_ba[i].HP*my_ba[i].ATK){
                                        ä¸€ç•ªå¼·ã„ã‚«ãƒ¼ãƒ‰ã®æ•°å€¤=my_ba[i].HP*my_ba[i].ATK;
                                        cursor2=i;
                                    } 
                                }
                            }
                            my_ba[cursor2]=death_card(my_ba[cursor2],my_haka,cursor2);
                        }
                        
                    }
                },AI:function(ã‚¿ã‚¤ãƒŸãƒ³ã‚°){
                    return true;//æ®ºã›ã‚‹ãƒ¤ãƒ„ãŒã„ã‚‹ãªã‚‰ã©ã‚“ã©ã‚“ä½¿ã£ã¦ã„ã‘ï¼
                },text:"ç›¸æ‰‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’1ä½“ç ´å£Šï¼(TOP_ACE ACEã‚’é™¤ã)",text_iro:[[14,7,"rgb(255,0,0)"],[22,3,"rgb(200,200,0)"]]};


                //ãƒ‡ãƒƒã‚­çµ„ã‚‚ã†ãœï¼
                var test_list={card_list:[[ryuunoitigeki,5],[test_card,4],[test_card2,4],[syuukun,1]],ACE:[test_card2],TOP_ACE:[syuukun]};
                //var deck_list={card_list:[[kinkyuujitai5,5],[test_card2,10],[syuukun,1]],ACE:[test_card2],TOP_ACE:[syuukun]};
                var zako_list={card_list:[[kinkyuujitai5,3],[ryuunoitigeki,5],[test_card,2],[test_card2,15]],ACE:[test_card,test_card,test_card2,test_card2],TOP_ACE:[test_card2,test_card2]};



                //deck_initialize(deck_list,my_deck,my_yamahuda);
                deck_initialize(test_list,my_deck,my_yamahuda);
                deck_initialize(zako_list,teki_deck,teki_yamahuda);
                
                pull_card(my_yamahuda,my_tehuda,3);
                /*
                for(let i=0;i<5;i++){
                    teki_ba[i]=teki_deck[39-i];
                    teki_ba[i].position="teki_ba_"+i;
                    teki_ba[i].move=5;
                }
                */
                //--------------------------------------------------------------------------------------------------------/--------------------------------------------------------------------------------------------------------
                setInterval(function(){//1ç§’ã«nå›å‹•ããï¼
                    time+=1;
                    if(time==1000){
                        time=0;
                    }

                    if(key_interval<=0 && key_input!="" && duel_phase!="ç›¸æ‰‹"){//ã‚­ãƒ¼ãŒé•·æŠ¼ã—ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯key_intervalãŒ0ã«ãªã£ã¦ã¦ã€ã‚­ãƒ¼æ“ä½œãŒé£›ã‚“ã§ããŸã‚‰
                        key_interval=3;//30*n/1000[s]ã®é–“ã€é•·æŠ¼ã—ã§ã®é€£ç¶šå…¥åŠ›ã‚’ç„¡åŠ¹ã€‚
                        for(let i=0;i<key_input.length;i++){
                            if(key_input.charAt(i)=="â†‘"){
                                if(duel_phase=="è‡ªç”±"){
                                    if(cursor<=2){
                                        cursor=16;
                                    }else if(cursor<=5){
                                        cursor=15;
                                    }else if(cursor==6){
                                        cursor=-1;
                                    }else if(cursor==11){
                                        cursor=5;
                                    }else if(cursor>=7 && cursor<=15){
                                        cursor-=1;
                                    }else if(cursor>=16){
                                        cursor=10;
                                    }
                                }else if(duel_phase=="æ”»æ’ƒ"){
                                    if(cursor!=3){//å±±æœ­ã¸ã®æ”»æ’ƒã˜ã‚ƒãªã„ãªã‚‰
                                        cursor-=1;
                                        if(cursor<=10){
                                            cursor=15;
                                        }
                                    }
                                }else if(duel_phase=="å¬å–š"){
                                    cursor-=1;
                                    if(cursor<=5){
                                        cursor=10;
                                    }
                                }else if(duel_phase=="é­”æ³•ç™ºå‹•ç¢ºèª" || duel_phase=="ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ‰ç¢ºèª"){
                                    cursor2=(cursor2+1)%2;
                                }else if(duel_phase=="æ•µé¸æŠ"){
                                    cursor2-=1;
                                    if(cursor2<0){
                                        cursor2=4;
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="â†"){
                                if(duel_phase=="è‡ªç”±"){
                                    if(cursor==-1){
                                        cursor=5;
                                    }else if(cursor<=5){ 
                                    cursor-=1;
                                    }else if(cursor>=11 && cursor<=15){
                                        cursor-=5;
                                    }else if(cursor>=17){
                                        cursor-=1;
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="â†’"){
                                if(duel_phase=="è‡ªç”±"){
                                    if(cursor<=4){
                                        cursor+=1;
                                    }else if(cursor==5){
                                        cursor=-1;
                                    }else if(cursor>=6 && cursor<=10){
                                        cursor+=5;
                                    }else if(cursor>=16 && cursor<=(my_tehuda.length+14)){
                                        cursor+=1;
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="â†“"){
                                if(duel_phase=="è‡ªç”±"){
                                    if(cursor<=2){
                                        cursor=6;
                                    }else if(cursor<=5){
                                        cursor=11;
                                    }else if(cursor<=9){
                                        cursor+=1;
                                    }else if(cursor==10){
                                        cursor=16;
                                    }else if(cursor<=15){
                                        cursor+=1;
                                    }else{
                                        cursor=-1;
                                    }
                                }else if(duel_phase=="æ”»æ’ƒ"){
                                    if(cursor!=3){//å±±æœ­ã¸ã®æ”»æ’ƒã˜ã‚ƒãªã„ãªã‚‰
                                        cursor+=1;
                                        if(cursor>=16){
                                            cursor=11;
                                        }
                                    }
                                }else if(duel_phase=="å¬å–š"){
                                    cursor+=1;
                                    if(cursor>=11){
                                        cursor=6;
                                    }
                                }else if(duel_phase=="é­”æ³•ç™ºå‹•ç¢ºèª" || duel_phase=="ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ‰ç¢ºèª"){
                                    cursor2=(cursor2+1)%2;
                                }else if(duel_phase=="æ•µé¸æŠ"){
                                    cursor2+=1;
                                    if(cursor2>4){
                                        cursor2=0;
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="ã€‡" && é•·æŠ¼ã—é˜»æ­¢==0){
                                é•·æŠ¼ã—é˜»æ­¢=1;
                                if(duel_phase=="è‡ªç”±"){
                                    if(cursor==-1){
                                        cursor2=0;
                                        duel_phase="ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ‰ç¢ºèª";
                                    }else if(cursor>=6 && cursor<=10 && my_ba[cursor-6]!=""){
                                        pre_cursor=cursor;//ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸã¨ãã«ã“ã“ã«æˆ»ã—ã¦ã‚ã’ãŸã„ã‚ˆã­ã€‚
                                        atk_card=my_ba[cursor-6];//ã“ã¡ã‚‰ã®æ”»æ’ƒã‚«ãƒ¼ãƒ‰
                                        if(atk_card.can_ATK>=1){
                                            duel_phase="æ”»æ’ƒ";
                                            if(ba_mons_num(teki_ba)==0){
                                                cursor=3;//æ•µãŒã„ãªã„å ´åˆã¯å±±æœ­ã«ã‚«ãƒ¼ã‚½ãƒ«åˆã‚ã›ã¦ã»ã—ã„ãª
                                            }else{
                                                cursor=11;
                                                for(let i=0;i<4;i++){//æ•µãŒã„ã‚‹ã¨ã“ã‚ã«ã‚«ãƒ¼ã‚½ãƒ«åˆã‚ã›ã‚ˆã†ãœã€‚
                                                    if(teki_ba[cursor-11]==""){
                                                        cursor+=1;
                                                    }else{
                                                        break;
                                                    }
                                                }
                                            }
                                            
                                        }
                                        

                                    }else if(cursor>=16 && my_tehuda.length!=0){
                                        pre_cursor=cursor;//ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸã¨ãã«ã“ã“ã«æˆ»ã—ã¦ã‚ã’ãŸã„ã‚ˆã­ã€‚
                                        tukau_card_num=cursor-16;
                                        if(my_tehuda[tukau_card_num].state.indexOf("ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼")!=-1){//æ‰‹æœ­ã«ã‚ã£ãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰ã‚’é¸ã‚“ã ãªï¼
                                            if(ba_mons_num(my_ba)!=5){//å ´ãŒã„ã£ã±ã„ã˜ã‚ƒãªã„ã®ã§ã€ã„ã‚„ã€ç”Ÿè´„å¬å–šç³»ãªã‚‰ã„ã£ã±ã„ã§ã‚‚ã„ã„ã®ã‹
                                                duel_phase="å¬å–š";
                                                cursor=10;
                                                for(let i=0;i<4;i++){//ã‚«ãƒ¼ãƒ‰ãŒãªã„ã¨ã“ã‚ã«ã‚«ãƒ¼ã‚½ãƒ«åˆã‚ã›ã‚ˆã†ãœã€‚
                                                    if(my_ba[cursor-6]!=""){
                                                        cursor-=1;
                                                    }else{
                                                        break;
                                                    }
                                                }
                                            }
                                        }else if(my_tehuda[tukau_card_num].state.indexOf("é­”æ³•")!=-1){//ãŸã¶ã‚“é­”æ³•ã ãœï¼
                                            if(my_tehuda[tukau_card_num].card.effect_req("æ‰‹æœ­ã‹ã‚‰")){//ç™ºå‹•æ¡ä»¶ç¢ºèªï¼
                                                if(my_tehuda[tukau_card_num].state.indexOf("æ•µé¸æŠ")!=-1){
                                                    duel_phase="æ•µé¸æŠ";
                                                    
                                                    for(let i=0;i<4;i++){//æ•µãŒã„ã‚‹ã¨ã“ã‚ã«ã‚«ãƒ¼ã‚½ãƒ«åˆã‚ã›ã‚ˆã†ãœã€‚
                                                        if(teki_ba[i]==""){
                                                        }else{
                                                            cursor2=i;
                                                            break;
                                                        }
                                                    }
                                                }else if(my_tehuda[tukau_card_num].state.indexOf("å‘³æ–¹é¸æŠ")!=-1){

                                                }else{//é¸æŠã—ãªã„ã‚¿ã‚¤ãƒ—ã ã¨â€¦æ€ã†
                                                    duel_phase="é­”æ³•ç™ºå‹•ç¢ºèª";
                                                    cursor2=0;
                                                }
                                            }else{//ä½¿ãˆãªã‹ã£ãŸã‚‰ãªã‚“ã‹ã—ã¦ã‚ã’ãŸã„ã¨ã„ã†æ°—æŒã¡ãŒãªã„ã¨ã„ã‚ã‘ã§ã‚‚ãªã„ãŒã€ã¨ãã«ãªã„

                                            }
                                            
                                        }
                                    }
                                }else if(duel_phase=="æ”»æ’ƒ"){
                                    if(cursor==3){//ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚¢ã‚¿ãƒƒã‚¯ï¼
                                        atk_yamahuda(atk_card.ATK,teki_yamahuda,teki_haka,teki_ba,teki_tehuda);
                                        atk_card.can_ATK-=1;//æ”»æ’ƒå¯èƒ½å›æ•°ãŒ1æ¸›ã‚‹
                                        my_ba[pre_cursor-6].move=-3;
                                        cursor=pre_cursor;
                                        zuba[3]=6;
                                        if(duel_phase=="æ”»æ’ƒ"){//ã“ã‚ŒãŒé€šã‚‰ãªã‹ã£ãŸã‚‰ã©ã£ã¡ã‹ãŒè² ã‘ã¦ã‚‹
                                            duel_phase="è‡ªç”±";
                                        }
                                        
                                    }else if(teki_ba[cursor-11]!=""){//ç›¸æ‰‹ã®ã„ã‚‹å ´æ‰€ã‚’æ”»æ’ƒ
                                        def_card=teki_ba[cursor-11];
                                        def_card.HP-=atk_card.ATK;
                                        if(def_card.HP<=0){//å€’ã—ãŸï½
                                            teki_ba[cursor-11]=death_card(def_card,teki_haka,cursor-11);
                                            //teki_ba[cursor-11]="";ã«ãªã‚‹ã‚ˆã‚“
                                            //def_card="";ã§ã¯ã ã‚ã€‚å‚ç…§ã¯ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å ´æ‰€ã—ã‹æ¸¡ã›ã¦ãªã„ã‚‰ã—ã„ã€ã˜ã‚ƒã‚æ¸¡ã›ã°ã„ã„ã˜ã‚ƒã‚“ï¼ã‚„ã ã‚ˆãƒãƒ¼ã‚«ï¼
                                        }
                                        atk_card.can_ATK-=1;//æ”»æ’ƒå¯èƒ½å›æ•°ãŒ1æ¸›ã‚‹
                                        my_ba[pre_cursor-6].move=-3;
                                        teki_ba[cursor-11].move=2;
                                        zuba[cursor]=6;
                                        cursor=pre_cursor;
                                        duel_phase="è‡ªç”±";
                                    }
                                }else if(duel_phase=="å¬å–š"){
                                    //ç”Ÿè´„å¬å–šã¨ã‹ã»ã—ã„ã­ã€çŸ¥ã‚‰ã‚“ã€‚
                                    if(my_ba[cursor-6]==""){//ã‚ã„ã¦ã‚‹ã˜ã‚ƒï½ã‚“
                                        my_ba[cursor-6]=syoukan(my_tehuda[tukau_card_num],"my_ba_"+(cursor-6));
                                        my_tehuda.splice(tukau_card_num,1);
                                        duel_phase="è‡ªç”±";
                                    }
                                    
                                }else if(duel_phase=="é­”æ³•ç™ºå‹•ç¢ºèª"){
                                    if(cursor2==0){//ç™ºå‹•ã™ã‚‹ã£ã¦ãªã‚‰
                                        my_tehuda[tukau_card_num].card.effect("æ‰‹æœ­ã‹ã‚‰");
                                        tukau_mahou[tukau_mahou.length]=[my_tehuda[tukau_card_num],50+card_kankaku*tukau_card_num,780,10];
                                        my_tehuda[tukau_card_num].position="my_haka";
                                        my_haka.push(my_tehuda[tukau_card_num]);

                                        my_tehuda.splice(tukau_card_num,1);
                                        if(cursor!=16 && cursor==(my_tehuda.length+16)){
                                            cursor-=1;//ã‚«ãƒ¼ã‚½ãƒ«ãŒãã®ã¾ã¾ã ã¨ã¯ã¿å‡ºã‚‹ã‹ã‚‰â€¦ã•ã€‚
                                        }
                                    }
                                    
                                    duel_phase="è‡ªç”±";
                                }else if(duel_phase=="æ•µé¸æŠ"){//ç™ºå‹•ã™ã‚‹ã£ã¦ãªã‚‰
                                    if(my_tehuda[tukau_card_num].card.effect("æ‰‹æœ­ã‹ã‚‰")){//åŠ¹æœãŒãªã„ã¨ãã¯falseãŒè¿”ã£ã¦ãã‚‹ãœï¼
                                        tukau_mahou[tukau_mahou.length]=[my_tehuda[tukau_card_num],50+card_kankaku*tukau_card_num,780,10];
                                        my_tehuda[tukau_card_num].position="my_haka";
                                        my_haka.push(my_tehuda[tukau_card_num]);

                                        my_tehuda.splice(tukau_card_num,1);
                                        if(cursor!=16 && cursor==(my_tehuda.length+16)){
                                            cursor-=1;//ã‚«ãƒ¼ã‚½ãƒ«ãŒãã®ã¾ã¾ã ã¨ã¯ã¿å‡ºã‚‹ã‹ã‚‰â€¦ã•ã€‚
                                        }
                                        duel_phase="è‡ªç”±";
                                    }
                                    
                                }else if(duel_phase=="ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ‰ç¢ºèª"){
                                    if(cursor2==0){//OK
                                        duel_phase="ç›¸æ‰‹";
                                        aite_phase="å§‹ã¾ã‚Š";
                                        cursor=16;
                                    }else{
                                        duel_phase="è‡ªç”±";
                                    }
                                }
                                
                            }else if(key_input.charAt(i)=="Ã—"){
                                if(duel_phase=="è‡ªç”±"){
                                    
                                }else if(duel_phase=="æ”»æ’ƒ"){
                                    duel_phase="è‡ªç”±";
                                    cursor=pre_cursor;
                                }else if(duel_phase=="å¬å–š"){
                                    duel_phase="è‡ªç”±";
                                    cursor=pre_cursor;
                                }else if(duel_phase=="é­”æ³•ç™ºå‹•ç¢ºèª" || duel_phase=="ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ‰ç¢ºèª" || duel_phase=="æ•µé¸æŠ"){
                                    duel_phase="è‡ªç”±";
                                }
                            }
                        }
                        if(key_owarasete==1){//ã‚‚ã†ãƒœã‚¿ãƒ³æŠ¼ã—ã¦ãªã„ã€‚æŠ¼ã—ã¦ãªã„ã¨ãã¯ã‚¤ãƒ™ãƒ³ãƒˆãã‚“ã§æ¤œçŸ¥ã™ã‚‹ã‚“ã ã‘ã©ã€å®Ÿè¡Œã‚ˆã‚Šã‚‚å…ˆã«ã‚¤ãƒ™ãƒ³ãƒˆãŒå‘¼ã°ã‚Œã¦ãŸã‚‰ã—ã‹ãŸãªã„ã®ã§ã“ã„ã¤ã§æ­¢ã‚ã‚‹
                            key_input="";
                            key_interval=0;
                        }
                        
                    }else if(key_interval>0){
                        key_interval=key_interval-1;//ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³
                    }

                    if(é•·æŠ¼ã—é˜»æ­¢==1 && key_input.indexOf("ã€‡")==-1){//ã€‡ãƒœã‚¿ãƒ³ã®é•·æŠ¼ã—é€£æ‰“é˜»æ­¢ã€‚
                        é•·æŠ¼ã—é˜»æ­¢=0; 
                    }
                    //ç›¸æ‰‹ã‚¿ãƒ¼ãƒ³æ“ä½œã¯ä¸‹ã®ã»ã†ã«ç½®ã„ã¨ãã­ã€‚ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦

                    if(duel_phase=="ç›¸æ‰‹"){
                        if(aite_delay>0){
                            aite_delay-=1;
                        }else if(aite_phase=="å§‹ã¾ã‚Š"){
                            for(let i=0;i<5;i++){
                                if(my_ba[i]!=""){
                                    my_ba[i].can_ATK=1;//åŠ¹æœã«ã‚ˆã£ã¦ã¯å¤‰ã‚ã‚‹ã‹ã‚‚ã­
                                }
                            }
                            pull_card(teki_yamahuda,teki_tehuda,2);//ç›¸æ‰‹ã®æ‰‹æœ­æšæ•°ã¯å³ä¸Šã®ã‚ãã“ã«è¡¨ç¤ºã—ã¦ã‚ã’ã‚‹ã¨ã‚„ã•ã—ã„ã¨æ€ã†ãªã€‚
                            teki_siyou_tehuda=[];
                            aite_phase="æ”»æ’ƒ";
                            console.log(teki_yamahuda.length);
                            
                        }else if(aite_phase=="æ”»æ’ƒ"){
                            aite_nayami="æ‚©ã‚€ãœï¼";
                            for(let i=0;i<5;i++){//æ”»æ’ƒåŠ›ãŒä¸€ç•ªé«˜ã„ã‚„ã¤ã‚’è¦‹ã¤ã‘ã‚‹ãœï¼
                                if(teki_ba[i]!=""){
                                    if(teki_ba[i].can_ATK>0){
                                        if(aite_nayami=="æ‚©ã‚€ãœï¼"){
                                            aite_nayami=i;
                                        }else if(teki_ba[aite_nayami].ATK<teki_ba[i].ATK){//æ”»æ’ƒåŠ›ãŒé«˜ã„ã‚„ã¤ã‹ã‚‰æ”»æ’ƒã—ã‚ˆã†ãœï¼ˆã“ã‚ŒãŒã„ã„ã®ã‹ã¯â€¦çŸ¥ã‚‰ã‚“ã€‚ï¼‰
                                            aite_nayami=i;
                                        }
                                    }
                                }
                            }
                            if(aite_nayami=="æ‚©ã‚€ãœï¼"){//æ”»æ’ƒã§ãã‚‹ã‚«ãƒ¼ãƒ‰ãŒãªã‹ã£ãŸãœï¼
                                aite_phase="å¬å–š";
                            }else{
                                teki_ba[aite_nayami].move=-3;
                                aite_delay=10;
                                atk_card=teki_ba[aite_nayami];
                                aite_nayami="æ‚©ã‚€ãœï¼";

                                for(let i=0;i<5;i++){//ä½“åŠ›ã¨ã‹æ”»æ’ƒåŠ›ã‚’åŠ å‘³ã—ã¦æ”»æ’ƒç›¸æ‰‹ã‚’æ±ºã‚ãŸã„ãœï¼
                                    if(my_ba[i]!=""){
                                        if(aite_nayami=="æ‚©ã‚€ãœï¼"){
                                            aite_nayami=i;
                                        }else if(my_ba[aite_nayami].ATK/Math.ceil(my_ba[aite_nayami].HP/atk_card.ATK)<my_ba[i].ATK/Math.ceil(my_ba[i].HP/atk_card.ATK)){//ãªã‚“ã‹æ®ºã—ã‚„ã™ãã¦å¼·ã„ã‚„ã¤ã‚’æ®´ã‚ã†
                                            aite_nayami=i;
                                        }
                                    }
                                }

                                if(aite_nayami=="æ‚©ã‚€ãœï¼"){//ä¿ºã®å ´ãŒã‚¬ãƒ©ç©ºãã ã
                                    atk_yamahuda(atk_card.ATK,my_yamahuda,my_haka,my_ba,my_tehuda);
                                    if(duel_phase!="ç›¸æ‰‹"){
                                        aite_phase="çµ‚ã‚ã‚Š";//ã©ã£ã¡ã‹è² ã‘ãŸã
                                    }
                                    zuba[0]=6;
                                }else{
                                    def_card=my_ba[aite_nayami];
                                    def_card.HP-=atk_card.ATK;
                                    if(def_card.HP<=0){//å€’ã—ãŸï½
                                        my_ba[aite_nayami]=death_card(def_card,my_haka,aite_nayami);
                                        //my_ba[aite_nayami]="";ã«ãªã‚‹ã‚ˆã‚“
                                        //def_card="";ã§ã¯ã ã‚ã€‚å‚ç…§ã¯ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å ´æ‰€ã—ã‹æ¸¡ã›ã¦ãªã„ã‚‰ã—ã„ã€ã˜ã‚ƒã‚æ¸¡ã›ã°ã„ã„ã˜ã‚ƒã‚“ï¼ã‚„ã ã‚ˆãƒãƒ¼ã‚«ï¼
                                    }
                                    my_ba[aite_nayami].move=2;
                                    zuba[aite_nayami+6]=6;
                                }
                                
                                atk_card.can_ATK-=1;//æ”»æ’ƒã—ãŸã‚‰â€¦ã­
                            }
                        }else if(aite_phase=="å¬å–š"){
                            aite_nayami="æ‚©ã‚€ãœï¼";
                            for(let i=0;i<teki_tehuda.length;i++){//æ‰‹æœ­ä½¿ã†ãœï¼    
                                if(teki_tehuda[i].state.indexOf("ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼")!=-1){//ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰ã‚„ã‚“ã‘ï¼
                                    for(let j=0;j<5;j++){
                                        if(teki_ba[ba_haiti[j]]==""){//ç©ºã„ã¦ã‚‹å ´æ‰€ã‚ã‚‹ã˜ã‚ƒã‚“ï¼
                                            
                                            teki_ba[ba_haiti[j]]=syoukan(teki_tehuda[i],"teki_ba_"+ba_haiti[j]);
                                            aite_delay=5;
                                            teki_tehuda.splice(i,1);
                                            aite_nayami="æ‰‹æœ­ä½¿ã£ãŸã‚ˆ";
                                            break;//
                                        }
                                    }
                                }else if(teki_tehuda[i].state.indexOf("é­”æ³•")!=-1 && teki_tehuda[i].card.effect_req("æ‰‹æœ­ã‹ã‚‰")){//é­”æ³•ã ã­ã€‚&& //ç™ºå‹•æ¡ä»¶ç¢ºèªï¼
                                    if(teki_tehuda[i].card.AI("æ‰‹æœ­ã‹ã‚‰")){//AIçš„ãªç™ºå‹•æ¡ä»¶
                                        aite_phase="ç›¸æ‰‹ç™ºå‹•ç¢ºèª";
                                        aite_nayami="ç¢ºèªå¾…ã¡ã ãœï¼";
                                        tukau_card_num=i;
                                        break;                                        
                                    }
                                    
                                }

                                if(aite_nayami=="æ‰‹æœ­ä½¿ã£ãŸã‚ˆ"){
                                    aite_phase="æ”»æ’ƒ";//å ´ãŒå¤‰åŒ–ã—ã¦ãã†ã ã‹ã‚‰æ”»æ’ƒæ¤œè¨ã—ãªãŠã—ã¦
                                    break;//æ‰‹æœ­ä¸€æšä½¿ã£ãŸã‚‰ãƒ«ãƒ¼ãƒ—ã—ãªãŠã—ã¦ãã¦
                                    
                                }
                            }
                            if(aite_nayami=="æ‚©ã‚€ãœï¼"){//ã‚„ã‚‹ã“ã¨ãªããªã£ãŸï¼Ÿ
                                aite_phase="çµ‚ã‚ã‚Š";
                                aite_delay=3;
                            }
                        
                        }else if(aite_phase=="çµ‚ã‚ã‚Š"){
                            duel_phase="è‡ªç”±";
                            pull_card(my_yamahuda,my_tehuda,3);
                            for(let i=0;i<5;i++){
                                if(teki_ba[i]!=""){
                                    teki_ba[i].can_ATK=1;//åŠ¹æœã«ã‚ˆã£ã¦ã¯å¤‰ã‚ã‚‹ã‹ã‚‚ã­
                                }
                            }
                            if(teki_yamahuda.length==0){//ã‚‚ã†å±±æœ­ãªã„ã˜ã‚ƒã‚“â€¦
                                teki_kougeki_sum=0;
                                for(let i=0;i<5;i++){//å ´ã®æ”»æ’ƒåŠ›ãŒâ€¦
                                    if(teki_ba[i]!=""){
                                        teki_kougeki_sum+=teki_ba[i].ATK;
                                    }
                                }
                                if(teki_kougeki_sum==0){//æ”»æ’ƒåŠ›ã®åˆè¨ˆã‚‚0ï¼ï¼Ÿã“ã‚Œã¯ã‚‚ã†ãƒ€ãƒ¡ã¿ãŸã„ã§ã™ã­ã€‚
                                    duel_phase="ä¿ºå‹ã¡";
                                }
                            }
                        
                        }
                        
                    }
                    ctx.fillStyle="rgb(130,255,170)";
                    ctx.fillRect(0,0,1000,1000);
                    ctx.drawImage(card_basyo,0,0);

                    //ã“ã“ã§è‡ªåˆ†ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚«ãƒ¼ãƒ‰ã‚’ä¸¦ã¹ã‚‹
                    ctx.save();
                    ctx.rotate(90 * Math.PI / 180);
                    for(let i=0;i<my_ba.length;i++){
                        if(my_ba[i].position=="my_ba_0"){//ãªã‚“ã‹å¦™ãªè¡¨ç¤ºåˆ¤å®šæ–¹æ³•æ¡ç”¨ã—ã¦ã¾ã™ã­â€¦ãªã‚“ã ã“ã‚Œã¯â€¦
                            card_draw(my_ba[i],105,-205+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_1"){
                            card_draw(my_ba[i],240,-215+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_2"){
                            card_draw(my_ba[i],375,-225+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_3"){
                            card_draw(my_ba[i],510,-215+my_ba[i].move*50);
                        }else if(my_ba[i].position=="my_ba_4"){   
                            card_draw(my_ba[i],645,-205+my_ba[i].move*50);
                        }
                        if(my_ba[i].move>0){
                            my_ba[i].move-=1;
                        }else if(my_ba[i].move<0){
                            my_ba[i].move+=1;
                        }
                    }
                    ctx.restore();
                                       

                    //ã“ã“ã§æ•µã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚«ãƒ¼ãƒ‰ã‚’ä¸¦ã¹ã‚‹
                    ctx.save();
                    ctx.rotate(270 * Math.PI / 180);
                    for(let i=0;i<teki_ba.length;i++){
                        if(teki_ba[i].position=="teki_ba_0"){
                            card_draw(teki_ba[i],-235,795+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_1"){
                            card_draw(teki_ba[i],-370,785+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_2"){
                            card_draw(teki_ba[i],-505,775+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_3"){
                            card_draw(teki_ba[i],-640,785+teki_ba[i].move*50);
                        }else if(teki_ba[i].position=="teki_ba_4"){
                            card_draw(teki_ba[i],-775,795+teki_ba[i].move*50);
                        }
                        if(teki_ba[i].move>0){
                            teki_ba[i].move-=1;
                        }else if(teki_ba[i].move<0){
                            teki_ba[i].move+=1;
                        }
                    }
                    ctx.restore();

                    //è‡ªåˆ†ã‚«ãƒ¼ãƒ‰ã®æ­»
                    ctx.save();
                    ctx.rotate(90 * Math.PI / 180);
                    for(let i=0;i<5;i++){
                        if(death_my_ba[i]!=""){
                            card_draw(death_my_ba[i],105+135*i+(death_my_ba[i].move%2)*10,-225+(Math.abs(2-i)*10)+(10-death_my_ba[i].move)*30);
                        }
                        if(death_my_ba[i].move>0){
                            death_my_ba[i].move-=1;
                            if(death_my_ba[i].move==0){
                                death_my_ba[i]="";
                            }
                        }
                    }
                    ctx.restore();

                    //ç›¸æ‰‹ã‚«ãƒ¼ãƒ‰ã®æ­»
                    ctx.save();
                    ctx.rotate(270 * Math.PI / 180);
                    for(let i=0;i<5;i++){
                        if(death_teki_ba[i]!=""){
                            card_draw(death_teki_ba[i],-235-135*i+(death_teki_ba[i].move%2)*10,775+(Math.abs(2-i)*10)+(10-death_teki_ba[i].move)*30);
                        }
                        if(death_teki_ba[i].move>0){
                            death_teki_ba[i].move-=1;
                            if(death_teki_ba[i].move==0){
                                death_teki_ba[i]="";
                            }
                        }
                    }
                    ctx.restore();

                    if(cursor==1){
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(240,110,520,670);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(250,120,500,650);
                        takusan_card_draw(my_haka,260,130,480,630);
                    }else if(cursor==4){
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(240,110,520,670);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(250,120,500,650);
                        takusan_card_draw(teki_haka,260,130,480,630);
                    }

                    ctx.fillStyle="rgb(0,0,0)";//ä¸Šã®ã»ã†ã‚’æã„ã¦ã¾ã™ã€‚
                    ctx.fillRect(105,5,440,90);
                    ctx.fillRect(555,5,440,90);
                    ctx.fillStyle="rgb(255,255,255)";
                    ctx.fillRect(110,10,430,80);
                    ctx.fillRect(560,10,430,80);
                    ctx.fillStyle="rgb(150,200,255)";
                    ctx.fillRect(388,12,150,76);
                    ctx.fillRect(838,12,150,76);
                    ctx.font = "50px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                    ctx.fillStyle="rgb(0,0,0)";
                    ctx.drawImage(turn_end,5,5);
                    ctx.drawImage(yamahuda,110,20);
                    ctx.fillText(my_yamahuda.length+yamahuda_damage[0], 174, 70);
                    ctx.drawImage(yamahuda,560,20);
                    ctx.fillText(teki_yamahuda.length+yamahuda_damage[1], 624, 70);
                    ctx.drawImage(hakaba,274,20);
                    ctx.fillText(my_haka.length-yamahuda_damage[0], 338, 70);
                    ctx.drawImage(hakaba,724,20);
                    ctx.fillText(teki_haka.length-yamahuda_damage[1], 788, 70);
                    if(yamahuda_damage[0]>0){
                        if(time%3==0){
                            yamahuda_damage[0]-=1;
                        }
                    }
                    if(yamahuda_damage[1]>0){
                        if(time%3==0){
                            yamahuda_damage[1]-=1;
                        }
                    }
                    if(my_tehuda.length>0){
                        ctx.drawImage(tehuda32,389,14);
                        ctx.font = "32px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText(my_tehuda.length, 425, 41);
                    }
                    if(teki_tehuda.length>0){
                        ctx.drawImage(tehuda32,839,14);
                        ctx.font = "32px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText(teki_tehuda.length, 875, 41);
                    }
                    

                    ctx.font = "40px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                    ctx.fillStyle="rgb(0,0,0)";
                    ctx.fillRect(5,785,990,210);
                    ctx.fillStyle="rgb(255,255,255)";
                    ctx.fillRect(10,790,980,200);
                    if(my_tehuda.length!=0){//ã“ã“ã‹ã‚‰æ‰‹æœ­-------------------
                        ctx.save();
                        tehuda_maisuu=my_tehuda.length;
                        if(tehuda_maisuu<7){
                            card_kankaku=130;
                        }else{
                            card_kankaku=850/tehuda_maisuu;
                        }
                        kakudo=25/tehuda_maisuu;
                        ctx.rotate(10 * Math.PI / 180);
                       for (let i=0;i<tehuda_maisuu;i++){                      
                            if((cursor-16)==i || ((pre_cursor-16)==i && duel_phase=="å¬å–š")){
                                card_draw(my_tehuda[i],(50+card_kankaku*i)*Math.cos((10+i*kakudo) * Math.PI / 180)+780*Math.sin((10+i*kakudo) * Math.PI / 180),780*Math.cos((10+i*kakudo) * Math.PI / 180)-(50+card_kankaku*i)*Math.sin((10+i*kakudo) * Math.PI / 180),-40);
                            }else{
                                card_draw(my_tehuda[i],(50+card_kankaku*i)*Math.cos((10+i*kakudo) * Math.PI / 180)+780*Math.sin((10+i*kakudo) * Math.PI / 180),780*Math.cos((10+i*kakudo) * Math.PI / 180)-(50+card_kankaku*i)*Math.sin((10+i*kakudo) * Math.PI / 180));
                            }
                            ctx.rotate(kakudo * Math.PI / 180);
                        }
                        ctx.restore();
                    }
                    
                    
                    

                    for (let i=0;i<16;i++){ //æ”»æ’ƒæ™‚ã«zuba64ã‚’è¡¨ç¤º
                        if(zuba[i]!=0){
                            zuba[i]-=1;
                            if(i==0){
                                ctx.drawImage(zuba64,110,20);
                            }else if(i==1){
                            }else if(i==2){
                            }else if(i==3){
                                ctx.drawImage(zuba64,560,20);
                            }else if(i==4){
                            }else if(i==5){
                            }else if(i==6){
                                ctx.drawImage(zuba64,20,100);
                            }else if(i==7){
                                ctx.drawImage(zuba64,30,235);
                            }else if(i==8){
                                ctx.drawImage(zuba64,40,370);
                            }else if(i==9){
                                ctx.drawImage(zuba64,30,505);
                            }else if(i==10){
                                ctx.drawImage(zuba64,20,640);
                            }else if(i==11){
                                ctx.drawImage(zuba64,916,170);
                            }else if(i==12){
                                ctx.drawImage(zuba64,906,305);
                            }else if(i==13){
                                ctx.drawImage(zuba64,896,440);
                            }else if(i==14){
                                ctx.drawImage(zuba64,906,575);
                            }else if(i==15){
                                ctx.drawImage(zuba64,916,710);
                            }
                            
                        }
                    }
                    
                    
                    //ã‚«ãƒ¼ã‚½ãƒ«è¡¨ç¤ºâ€¦
                    if(cursor==-1){  ctx.drawImage(yubi,-10,80+4*Math.sin(time*Math.PI/8)); //å·¦ä¸Š ãªã‚“ã§-1ã‹ã‚‰å§‹ã¾ã£ã¦ã‚‹ã®ï¼Ÿã€€ãã‚Œã¯ã­ã€è¨­è¨ˆãƒŸã‚¹ã•ï¼
                    }else if(cursor==0){  ctx.drawImage(yubi,110,80+4*Math.sin(time*Math.PI/8)); 
                    }else if(cursor==1){  ctx.drawImage(yubi,260,80+4*Math.sin(time*Math.PI/8));
                    }else if(cursor==2){  ctx.drawImage(yubi,400,80+4*Math.sin(time*Math.PI/8));

                    }else if(cursor==3){ ctx.drawImage(yubi,560,80+4*Math.sin(time*Math.PI/8));//å³ä¸Š
                    }else if(cursor==4){ctx.drawImage(yubi,710,80+4*Math.sin(time*Math.PI/8));
                    }else if(cursor==5){ctx.drawImage(yubi,850,80+4*Math.sin(time*Math.PI/8));


                    }else if(cursor==6){//å·¦å ´
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,105,-100+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==7){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,245,-110+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==8){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,375,-120+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==9){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,510,-110+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==10){
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,645,-100+4*Math.sin(time*Math.PI/8));
                        ctx.restore();

                    }else if(cursor==11){//å³ã°
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-235,900+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==12){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-370,890+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==13){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-505,880+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==14){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-640,890+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }else if(cursor==15){
                        ctx.save();
                        ctx.rotate(270 * Math.PI / 180);
                        ctx.drawImage(yubi,-775,900+4*Math.sin(time*Math.PI/8));
                        ctx.restore();

                    }else{//æ‰‹æœ­ã§ãƒ¤ãƒ³ã‚¹ã€‚
                        ctx.save();
                        ctx.rotate((10+kakudo*(cursor-16)) * Math.PI / 180);
                        ctx.drawImage(yubi,(50+card_kankaku*(cursor-16))*Math.cos((10+(cursor-16)*kakudo) * Math.PI / 180)+780*Math.sin((10+(cursor-16)*kakudo) * Math.PI / 180),100+4*Math.sin(time*Math.PI/8)+780*Math.cos((10+(cursor-16)*kakudo) * Math.PI / 180)-(50+card_kankaku*(cursor-16))*Math.sin((10+(cursor-16)*kakudo) * Math.PI / 180));
                        ctx.restore();
                    }
                    if(duel_phase=="æ•µé¸æŠ"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,780,1000,100);
                        ctx.fillRect(230,100,540,680);
                        ctx.fillRect(0,100,230,(pre_cursor-6)*135);
                        ctx.fillRect(0,105+(pre_cursor-5)*135,230,(10-pre_cursor)*135);
                        ctx.fillRect(0,0,1000,100);
                        
                        ctx.fillStyle="rgb(0,150,0)";
                        ctx.fillRect(0,800,1000,200);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(200,825,600,150);
                        ctx.font = "80px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,200,0)";
                        ctx.fillText("é­”æ³•å¯¾è±¡é¸æŠï¼", 225, 900);
                        ctx.font = "30px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillText("ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼šÃ—", 570, 960);
                        if(cursor2==0){//å³ã°
                            ctx.save();
                            ctx.rotate(270 * Math.PI / 180);
                            ctx.drawImage(yubi,-235,900+4*Math.sin(time*Math.PI/8));
                            ctx.restore();
                        }else if(cursor2==1){
                            ctx.save();
                            ctx.rotate(270 * Math.PI / 180);
                            ctx.drawImage(yubi,-370,890+4*Math.sin(time*Math.PI/8));
                            ctx.restore();
                        }else if(cursor2==2){
                            ctx.save();
                            ctx.rotate(270 * Math.PI / 180);
                            ctx.drawImage(yubi,-505,880+4*Math.sin(time*Math.PI/8));
                            ctx.restore();
                        }else if(cursor2==3){
                            ctx.save();
                            ctx.rotate(270 * Math.PI / 180);
                            ctx.drawImage(yubi,-640,890+4*Math.sin(time*Math.PI/8));
                            ctx.restore();
                        }else if(cursor2==4){
                            ctx.save();
                            ctx.rotate(270 * Math.PI / 180);
                            ctx.drawImage(yubi,-775,900+4*Math.sin(time*Math.PI/8));
                            ctx.restore();

                        }
                    }else if(duel_phase=="é­”æ³•ç™ºå‹•ç¢ºèª"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,1000,1000);
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(290,790,420,200);
                        ctx.fillStyle="rgb(200,255,200)";
                        ctx.fillRect(300,800,400,180);
                        ctx.font = "50px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText("ä½¿ã†", 500, 870);
                        ctx.fillText("ã‚„ã‚ã‚‹", 500, 950);
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,790+cursor2*80,-480+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }

                    //ã‚«ãƒ¼ãƒ‰ã®è©³ç´°è¡¨ç¤º
                    if((cursor>=6 &&cursor<=10 && (my_ba[cursor-6]!="")) || (cursor>=11 && cursor<=15 && (teki_ba[cursor-11]!="")) || (cursor>=16 && my_tehuda.length!=0)){//ã‚«ãƒ¼ãƒ‰è©³ç´°ã‚’è¡¨ç¤ºã™ã‚‹ã¨ãã¯ã‚«ãƒ¼ãƒ‰ãŒã‚ã‚‹ã¨ãã ã‘ã ãœï¼
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(240,110,520,670);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(250,120,500,650);
                        if(cursor<=10){
                            syousai_card=my_ba[cursor-6];
                        }else if(cursor<=15){
                            syousai_card=teki_ba[cursor-11];
                        }else{
                            syousai_card=my_tehuda[cursor-16];
                        }
                        ctx.fillStyle="rgb(200,200,200)";
                        ctx.fillRect(255,125,490,50);
                        ctx.font = "50px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText(syousai_card.card.name, 260, 168);
                        ctx.drawImage(syousai_card.card.image,260,180);

                        if(syousai_card.state.indexOf("ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼")!=-1){
                            ctx.drawImage(atk_plate,400,180);
                            ctx.drawImage(def_plate,450,185);
                            ctx.fillText("(", 570, 225);
                            ctx.drawImage(atk_plate,600,180);
                            ctx.drawImage(def_plate,650,185);
                            ctx.fillText(")", 704, 225);
                            ctx.font = "40px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                            ctx.fillStyle="rgb(255,255,255)";
                            if(syousai_card.ATK<10){
                                ctx.fillText(syousai_card.ATK, 414, 222);
                            }else{
                                ctx.fillText(syousai_card.ATK, 404, 222);
                            }
                            if(syousai_card.HP<10){
                                ctx.fillText(syousai_card.HP, 464, 222);
                            }else{
                                ctx.fillText(syousai_card.HP, 454, 222);
                            }
                            if(syousai_card.card.ATK<10){
                                ctx.fillText(syousai_card.card.ATK, 614, 222);
                            }else{
                                ctx.fillText(syousai_card.card.ATK, 604, 222);
                            }
                            if(syousai_card.card.HP<10){
                                ctx.fillText(syousai_card.card.HP, 664, 222);
                            }else{
                                ctx.fillText(syousai_card.card.HP, 654, 222);
                            }
                        }
                        ctx.fillStyle="rgb(0,0,0)";
                        text_kaigyou_hyouji(syousai_card.card.text, 260, 380,480,240,40,syousai_card.card.text_iro);//x,yã¯å·¦ä¸ŠæŒ‡å®šã ã‹ã‚‰æ³¨æ„ã ï¼
                        ctx.fillRect(255,600,490,2);
                        syousai_state_color=[];
                        syousai_state="åˆ†é¡:";
                        for(let i=0;i<syousai_card.state.length;i++){
                            if(syousai_card.state[i]=="TOP_ACE"){
                                syousai_state_color[syousai_state_color.length]=[syousai_state.length+1,7,"rgb(255,0,0)"];
                            }else if(syousai_card.state[i]=="ACE"){
                                syousai_state_color[syousai_state_color.length]=[syousai_state.length+1,7,"rgb(200,200,0)"];
                            }
                            syousai_state+=" "+syousai_card.state[i];
                        }
                        text_kaigyou_hyouji(syousai_state, 260, 610,480,160,40,syousai_state_color);//x,yã¯å·¦ä¸ŠæŒ‡å®šã ã‹ã‚‰æ³¨æ„ã ï¼
                        
                    }

                    if(duel_phase=="å¬å–š"){//ä»Šãªã‚“ã®çŠ¶æ…‹ãªã‚“ã ã‚ˆã£ã¦ã„ã†ãŠå®¢æ§˜ã®å£°ã«ãŠç­”ãˆã™ã‚‹å½¢ã«ãªã£ãŸ
                        ctx.save();
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,230,100);
                        ctx.fillRect(0,780,230,220);
                        ctx.fillRect(230,0,770,1000);
                        ctx.rotate(45 * Math.PI / 180);
                        ctx.fillStyle="rgb(0,0,150)";
                        ctx.fillRect(200,-525,1000,200);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(400,-500,600,150);
                        ctx.font = "80px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,200)";
                        ctx.fillText("å¬å–šå ´æ‰€é¸æŠï¼", 440, -400);
                        ctx.font = "30px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillText("ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼šÃ—", 750, -360);
                        ctx.restore();
                    }else if(duel_phase=="æ”»æ’ƒ"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,780,1000,100);
                        ctx.fillRect(230,100,540,680);
                        ctx.fillRect(0,100,230,(pre_cursor-6)*135);
                        ctx.fillRect(0,105+(pre_cursor-5)*135,230,(10-pre_cursor)*135);
                        if(cursor==3){
                            ctx.fillRect(0,0,550,100);
                            ctx.fillRect(700,0,300,100);
                            ctx.fillRect(770,100,230,800);
                        }else{
                            ctx.fillRect(0,0,1000,100);
                        }
                        ctx.fillStyle="rgb(150,0,0)";
                        ctx.fillRect(0,800,1000,200);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(200,825,600,150);
                        ctx.font = "80px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(200,0,0)";
                        ctx.fillText("æ”»æ’ƒå¯¾è±¡é¸æŠï¼", 225, 900);
                        ctx.drawImage(atk_circle,100+10*Math.sin(time*Math.PI/64),850+8*Math.sin(time*Math.PI/16));
                        ctx.drawImage(atk_circle,836+10*Math.sin(time*Math.PI/64),850+8*Math.sin(time*Math.PI/16));
                        ctx.font = "30px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillText("ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼šÃ—", 570, 960);
                    }else if(duel_phase=="ç›¸æ‰‹"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,100,100);
                        ctx.fillRect(0,780,1000,220);
                        ctx.fillRect(0,100,15,680);
                        ctx.fillRect(985,0,15,780);
                        ctx.fillRect(100,0,885,15);
                        ctx.fillStyle="rgb(50,50,50)";
                        ctx.fillRect(230,100,540,680);
                        ctx.font = "40px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillText("ç›¸æ‰‹ã‚¿ãƒ¼ãƒ³", 300, 300);
                        //ctx.fillText("å¬å–š", 400, 400);
                    }else if(duel_phase=="ä¿ºå‹ã¡"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,1000,1000);
                        ctx.fillStyle="rgb(255,55,55)";
                        ctx.fillRect(150,100,700,700);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(200,150,600,600);

                        ctx.font = "80px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText("å‹ã£ãŸï¼", 250, 250);
                        ctx.font = "40px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillText("ãŠã‚ã‚Œã¨", 250, 350);
                        ctx.drawImage(kati_image,550,500);
                    }else if(duel_phase=="æ•µå‹ã¡"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,1000,1000);
                        ctx.fillStyle="rgb(55,55,255)";
                        ctx.fillRect(150,100,700,700);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(200,150,600,600);

                        ctx.font = "80px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText("è² ã‘ãŸï¼", 250, 250);
                        ctx.font = "40px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillText("ããˆãƒ¼", 250, 350);
                        ctx.drawImage(make_image,550,525);
                    }else if(duel_phase=="ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ‰ç¢ºèª"){
                        ctx.fillStyle="rgb(0,0,0,0.5)";
                        ctx.fillRect(0,0,1000,1000);
                        ctx.fillStyle="rgb(200,100,55)";
                        ctx.fillRect(250,50,700,480);
                        ctx.fillStyle="rgb(255,220,200)";
                        ctx.fillRect(275,75,650,430);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(295,200,610,280);
                        ctx.font = "80px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText("ã‚¿ãƒ¼ãƒ³ã‚¨ãƒ³ãƒ‰", 400, 175);
                        ctx.drawImage(turn_end,300,100);
                        
                        ctx.fillText("OK", 450, 300);
                        ctx.fillText("ã‚­ãƒ£ãƒ³ã‚»ãƒ«", 450, 430);
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,200+cursor2*140,-430+4*Math.sin(time*Math.PI/8));
                        ctx.restore();
                    }

                    if(tukau_mahou.length!=0){                        
                        for(let i=tukau_mahou.length-1;i>=0;i--){
                            console.log(tukau_mahou[i][1]+" "+tukau_mahou[i][2]);
                            card_draw(tukau_mahou[i][0],tukau_mahou[i][1],tukau_mahou[i][2]-300+tukau_mahou[i][3]*tukau_mahou[i][3]*3);
                            tukau_mahou[i][3]-=1;
                            if(tukau_mahou[i][3]==0){
                                tukau_mahou.splice(i,1);
                            }
                        }
                    }
                    
                    if(aite_phase=="ç›¸æ‰‹ç™ºå‹•ç¢ºèª"){
                        
                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(240,110,520,670);
                        ctx.fillStyle="rgb(255,255,255)";
                        ctx.fillRect(250,120,500,650);
                        syousai_card=teki_tehuda[tukau_card_num];
                        ctx.fillStyle="rgb(200,200,200)";
                        ctx.fillRect(255,125,490,50);
                        ctx.font = "50px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText(syousai_card.card.name, 260, 168);
                        ctx.drawImage(syousai_card.card.image,260,180);

                        ctx.fillStyle="rgb(0,0,0)";
                        text_kaigyou_hyouji(syousai_card.card.text, 260, 380,480,240,40,syousai_card.card.text_iro);//x,yã¯å·¦ä¸ŠæŒ‡å®šã ã‹ã‚‰æ³¨æ„ã ï¼
                        ctx.fillRect(255,600,490,2);
                        syousai_state_color=[];
                        syousai_state="åˆ†é¡:";
                        for(let i=0;i<syousai_card.state.length;i++){
                            if(syousai_card.state[i]=="TOP_ACE"){
                                syousai_state_color[syousai_state_color.length]=[syousai_state.length+1,7,"rgb(255,0,0)"];
                            }else if(syousai_card.state[i]=="ACE"){
                                syousai_state_color[syousai_state_color.length]=[syousai_state.length+1,7,"rgb(200,200,0)"];
                            }
                            syousai_state+=" "+syousai_card.state[i];
                        }
                        text_kaigyou_hyouji(syousai_state, 260, 610,480,160,40,syousai_state_color);//x,yã¯å·¦ä¸ŠæŒ‡å®šã ã‹ã‚‰æ³¨æ„ã ï¼

                        ctx.fillStyle="rgb(55,55,55)";
                        ctx.fillRect(90,790,820,200);
                        ctx.fillStyle="rgb(200,255,200)";
                        ctx.fillRect(100,800,800,180);
                        ctx.font = "50px  'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'";//ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã€‚å·¦ã®ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„ã¨å³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ã‚‰ã—ã„ã€‚
                        ctx.fillStyle="rgb(0,0,0)";
                        ctx.fillText("ãƒ»ç™ºå‹•ã•ã‚Œã¾ã—ãŸï¼", 150, 870);
                        ctx.fillText("OK", 380, 950);
                        ctx.save();
                        ctx.rotate(90 * Math.PI / 180);
                        ctx.drawImage(yubi,870,-370+4*Math.sin(time*Math.PI/8));
                        ctx.restore();

                        if(key_input.indexOf("ã€‡")!=-1 || key_input.indexOf("Ã—")!=-1){
                            teki_tehuda[tukau_card_num].card.effect("æ‰‹æœ­ã‹ã‚‰");
                            teki_tehuda[tukau_card_num].position="teki_haka";
                            teki_haka.push(teki_tehuda[tukau_card_num]);
                            aite_delay=5;
                            teki_tehuda.splice(tukau_card_num,1);
                            aite_phase="æ”»æ’ƒ";
                        }
                    }
                },30);//30/1000[s]ã§ãã‚Šã‹ãˆã™ãï¼
                
            }
            
        </script>
    </head>
    <body>


        <div id="top"></div>
        <header id="header">
            <button onclick="html_link_btn()" id="html_link_btn"></button>
            <nav id="html_link_nav">
                <ul id="html_link_ul"></ul>
            </nav>
            <a href="../index.html">
                <img id="go_home" src="../images/site/omotyabako_deka.png" alt="ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸" height="1px"><!--ã“ã“ã§é«˜ã•ã‚’å…¥ã‚Œã¦ãŠã‹ãªã„ã¨ã€ã‚¯ã‚½ã§ã‹ã„ç”»åƒãŒä¸€ç¬èª­ã¿è¾¼ã¾ã‚Œã¦ãƒœã‚¿ãƒ³ã®å¤§ãã•ãŒæš´èµ°ã™ã‚‹-->
            </a>
            <h1 id="title_h1">
                JUNæ±ï½—ãŠã‚‚ã¡ã‚ƒã°ã“ã€‚
            </h1>
        </header>

        <div id="mannaka">

            <table border="5" bordercolor="#ffffff" align="center">
                <tr>
                    <td> ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰</td> <td bgcolor="#005000">ç§»å‹• : WASD,â†‘â†â†’â†“,KHLJ</td> <td bgcolor="#500000">ã€‡ : Enter</td> <td bgcolor="#000050">Ã— : Shift</td>
                </tr>
            </table> 
            
            <div id="parent_div">
                <canvas id="cnvs" height="1000px" width="1000px"><!--styleã®heigthã¯è¦‹ãŸç›®ã®å¤§ãã•ã‚’å¤‰ãˆã¦ã„ã‚‹ã«ã™ããªã„ã€‚è¡¨ç¤ºé ˜åŸŸã¯cssã˜ã‚ƒãªã„ã€‚-->
                </canvas>
            </div>
            <div id="buttons">
                <div id="button_left">
                    <div>
                        <input type="button" class="key_button" value="â†‘">
                    </div>
                    <div>
                        <input type="button" class="key_button" value="â†">
                        <input type="button" class="key_button" value="â†’">
                    </div>
                    <div>
                        <input type="button" class="key_button" value="â†“">
                    </div>
                    
                </div>
                <div id="button_right">
                    <input type="button" class="key_button" value="ã€‡">
                    <input type="button" class="key_button" value="Ã—">
                </div>
            </div>
            

            <footer>
                <ul id="footul">
                    <li id="foot_tweet_li">
                        <a href="" id="foot_tweet_a"><!--onload_functions()ã§hrefã‚’æ›¸ãè¾¼ã‚“ã§ã‚‹ã§ï¼-->
                            <img src="../images/site/twitterbutton.gif" alt="ãƒ„ã‚¤ãƒ¼ãƒˆãƒœã‚¿ãƒ³" id="tweet_img">
                        </a>
                    </li>
                    <li>
                        <a href="#top" id="totop"> 
                            ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã«ç§»å‹•
                        </a>
                    </li>
                </ul>
            </footer>
        </div>
    </body>
</html>
