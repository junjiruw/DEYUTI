<!DOCTYPE html>
<html lang="ja">
    <head prefix="og: http://ogp.me/ns# website: http://ogp.me/ns/website#">
        <meta charset="UTF-8">
        <!--文字コードは上のほうにないとすべておしまいになるらしい-->
        <meta name="description" content="技術的なテストをしている">
        <title>JUN汁ｗおもちゃばこ。/TEST</title>
        <!--OGPとかいうの-->
        <meta property="og:site_name" content="JUN汁ｗおもちゃばこ。/TEST">
        <meta property="og:title" content="テスト用ページ"/>
        <meta property="og:type" content="website"/> <!--websiteはトップページだってさ-->
        <meta property="og:url" content="https://junjiruw.github.io/DEYUTI/test/gomibako_for_test"/>
        <meta property="og:image" content="https://github.com/junjiruw/DEYUTI/blob/master/images/site/junjiruw_bako.png?raw=true"/>
        <meta name="twitter:card" content="summary"><!--なにを表示するか-->
        <meta name="twitter:site" content="@junjiruw"><!--フッターに表示されるらしい…どこ？-->
        <link rel="stylesheet" href="../css/style.css">
        
        <link rel="icon" href="../images/site/favicon32.png">
        <style>
            div#mannaka{
                width: 98%;
                margin: auto;
                background: #16151a;
                border: 2px solid #ffffff;
                color: #ffffff;   
                font-size: 16px;    
            }

            div#parent_div{
                text-align: center;
                margin: 10px;
            }
            canvas{
                background: #242424;
                height: 70vh;/*これ、PCブラウザで横に狭くしたら崩壊せえへん？→勝手に崩壊してろ*/
                image-rendering: pixelated;/*ドット絵を拡大したいなら使え*/
            }

        </style>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-1MB5XLN4LW"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-1MB5XLN4LW');
        </script>

        <script src="../js/public.js"></script>

        <!--pixiJSを読み込もう-->
        <script src="../js/library/pixi.min.js"></script>
        <!--Pixi-soundを読み込もう-->
        <script src="../js/library/pixi-sound.js"></script>
        <!--ライセンス表記はコイツの中に書いてあったぜ！-->

        <script>
            onload = function(){
                onload_functions();
                const canvas =document.getElementById("canvas")
                const app = new PIXI.Application({//PIXIアプリを作成
                    view : canvas, //canvas指定
                    //antialias : true,//アンチエイリアス。デフォルトOFF
                    width:100,
                    height:100,
                });

                PIXI.settings.SCALE_MODE = PIXI.SCALE_MODES.NEAREST;//ドット絵ぼやけさせてんじゃねーぞ！



                const 図=new PIXI.Graphics();//一つでええ
                app.stage.addChild(図);
                図.lineStyle(4,0xffffff,1);
                図.moveTo(100,100);
                図.lineTo(0,0);
                図.lineTo(50,0);
                図.lineTo(0,50);
                図.lineTo(100,50);
                図.lineTo(100,100);
                図.drawRect(0,50,50,50);
                //図.clear();

                const fontstyle=new PIXI.TextStyle({
                    fontSize: 0,
                    fill: [0xffffff,0xff0000,0x00ff00],
                    dropShadow: true,
                    dropShadowColor:0x0000ff,
                    fontStyle: "italic",
                    fontWeight: 900,

                })
                fontstyle.fontSize+=10;
                const titleText = new PIXI.Text( "Hello World!" ,fontstyle);
                titleText.position.set(15,30);
                app.stage.addChild( titleText );

                const 画像= PIXI.Texture.from("../images/omocha/tuntunsyuukun/untiking.png");//ロード。スプライト作成も同時にできるっぽいけど、いっか。
                const スプライト=new PIXI.Sprite(画像);
                スプライト.anchor.set(0.5,0.5);
                app.stage.addChild(スプライト);

                const スプライト2=new PIXI.Sprite(画像);
                スプライト2.anchor.set(0.5,0.5);
                スプライト2.scale.set(0.8,2);
                スプライト2.position.set(50,80);
                スプライト2.rotation=Math.PI*4/5;
                let 回転方向=1;
                スプライト2.on("pointerdown",()=>{
                    回転方向*=-1;
                    poyo_sound.play();
                });
                スプライト2.isOver = false;  
                スプライト2.cursor = "pointer";//カーソル変化
                スプライト2.interactive=true;//タッチ操作許可
                app.stage.addChild(スプライト2);

                const peu_sound = PIXI.sound.Sound.from('../sound/omocha/tuntunsyuukun/peu.wav');
                const poyo_sound = PIXI.sound.Sound.from('../sound/omocha/tuntunsyuukun/poyo.wav');

                app.ticker.add(loop);
                let time=0;
                let mouseX=0;
                let mouseY=0;
                canvas.onclick = function(event) {//キャンバスクリック
                    let mouse = canvas.getBoundingClientRect();//キャンバスどこだよ
                    mouseX = (event.clientX - Math.floor(mouse.left))/canvas.clientWidth*canvas.width;//(マウス位置 - キャンバス位置)/キャンバスの見た目でかさ*キャンバス本質でかさ
                    mouseY = (event.clientY - Math.floor(mouse.top))/canvas.clientHeight*canvas.height;
                    if((mouseX<スプライト2.position.x-18 || mouseX>スプライト2.position.x+18)||(mouseY<スプライト2.position.y-18 || mouseY>スプライト2.position.y+18)){
                        スプライト.position.set(mouseX,mouseY);
                    peu_sound.play();
                    }

                }

                function loop(delta){//1/60[s]くらいで動く。引数は前フレームからの経過時間*60  app.ticker.speed = 3;で変えられるらしいっすよ
                    time+=delta;
                    if(time>1000000){time=0;}
                    スプライト2.scale.set(0.8,Math.sin(time/10)+1.5);
                    スプライト2.rotation=Math.PI*(time)/20*回転方向;

                }
            }
        </script>
    </head>
    <body>


        <div id="top"></div>
        <header id="header">
            <button onclick="html_link_btn()" id="html_link_btn"></button>
            <nav id="html_link_nav">
                <ul id="html_link_ul"></ul>
            </nav>
            <a href="../index.html">
                <img id="go_home" src="../images/site/omotyabako_deka.png" alt="トップページへ" height="1px"><!--ここで高さを入れておかないと、クソでかい画像が一瞬読み込まれてボタンの大きさが暴走する-->
            </a>
            <h1 id="title_h1">
                JUN汁ｗおもちゃばこ。
            </h1>
        </header>

        <div id="mannaka">
            PixiJSっていうらしいっすよ
            <div id="parent_div">
                <canvas id="canvas">
                </canvas>
            </div>


            <footer>
                <ul id="footul">
                    <li id="foot_tweet_li">
                        <a href="" id="foot_tweet_a"><!--onload_functions()でhrefを書き込んでるで！-->
                            <img src="../images/site/twitterbutton.gif" alt="ツイートボタン" id="tweet_img">
                        </a>
                    </li>
                    <li>
                        <a href="#top" id="totop"> 
                            ページ上部に移動
                        </a>
                    </li>
                </ul>
            </footer>
        </div>
    </body>
</html>
